\hypertarget{iir_8h_source}{}\doxysection{iir.\+h}
\label{iir_8h_source}\index{C:/Qt\_projects/DigitalFilters\_x32/include/iir.h@{C:/Qt\_projects/DigitalFilters\_x32/include/iir.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2 \textcolor{comment}{// A.Tykvinskiy , 23.12.2021}}
\DoxyCodeLine{3 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{4 \textcolor{comment}{// INFINITE IMPULSE RESPONSE FILTERS}}
\DoxyCodeLine{5 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{6 \textcolor{comment}{/*}}
\DoxyCodeLine{7 \textcolor{comment}{    Naming conventions:}}
\DoxyCodeLine{8 \textcolor{comment}{}}
\DoxyCodeLine{9 \textcolor{comment}{    IIR -\/ infinite impulse response}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{    plp   -\/ poles of the normalized lowpass analogue prototype}}
\DoxyCodeLine{12 \textcolor{comment}{    zlp   -\/ zeros of the normalized lowpass analogue prototype}}
\DoxyCodeLine{13 \textcolor{comment}{    glp   -\/ gains of the normalized lowpass analogue prototype}}
\DoxyCodeLine{14 \textcolor{comment}{    pbp   -\/ poles of the bandpass analogue/digital prototype}}
\DoxyCodeLine{15 \textcolor{comment}{    zbp   -\/ zeros of the bandpass analogue/digital prototype}}
\DoxyCodeLine{16 \textcolor{comment}{    gbp   -\/ gains of the bandpass analogue/digital prototype}}
\DoxyCodeLine{17 \textcolor{comment}{    pbs   -\/ poles of the bandstop analogue/digital prototype}}
\DoxyCodeLine{18 \textcolor{comment}{    zbs   -\/ zeros of the bandstop analogue/digital prototype}}
\DoxyCodeLine{19 \textcolor{comment}{    gbs   -\/ gains of the bandstop analogue/digital prototype}}
\DoxyCodeLine{20 \textcolor{comment}{    L     -\/ complex conjugate poles / zeros second order sections number}}
\DoxyCodeLine{21 \textcolor{comment}{    R     -\/ real odd second order section identifier}}
\DoxyCodeLine{22 \textcolor{comment}{    N     -\/ second order sections total numbeer}}
\DoxyCodeLine{23 \textcolor{comment}{    Fs    -\/ sampling frequecny        , Hz}}
\DoxyCodeLine{24 \textcolor{comment}{    Ts    -\/ sampling period           , s}}
\DoxyCodeLine{25 \textcolor{comment}{    Fn    -\/ nominal frequency         , Hz}}
\DoxyCodeLine{26 \textcolor{comment}{    Fc    -\/ cutoff frequency          , Hz}}
\DoxyCodeLine{27 \textcolor{comment}{    BW    -\/ stopband / passband width , Hz}}
\DoxyCodeLine{28 \textcolor{comment}{    Gs    -\/ stopband attenuation      , Db}}
\DoxyCodeLine{29 \textcolor{comment}{    Gp    -\/ passband attenuation      , Db}}
\DoxyCodeLine{30 \textcolor{comment}{    order -\/ IIR filter order}}
\DoxyCodeLine{31 \textcolor{comment}{    type  -\/ IIR filter type ( 0 -\/ lowpass , 1 -\/ highpass , 2 -\/ bandpass , 3 -\/ bandstop )}}
\DoxyCodeLine{32 \textcolor{comment}{    cfnum -\/ second order sections numeator coefficients}}
\DoxyCodeLine{33 \textcolor{comment}{    cfden -\/ second order sections denominator coefficients}}
\DoxyCodeLine{34 \textcolor{comment}{    gains -\/ second order sections gains ( including filter output gain )}}
\DoxyCodeLine{35 \textcolor{comment}{    bx    -\/ second order sections input  buffers}}
\DoxyCodeLine{36 \textcolor{comment}{    by    -\/ second order sections output buffers}}
\DoxyCodeLine{37 \textcolor{comment}{    Km    -\/ filter amplitude frequency response}}
\DoxyCodeLine{38 \textcolor{comment}{    pH    -\/ filter phase frequency response}}
\DoxyCodeLine{39 \textcolor{comment}{}}
\DoxyCodeLine{40 \textcolor{comment}{*/}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{preprocessor}{\#ifndef IIR\_H}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#define IIR\_H}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{preprocessor}{\#ifndef \_\_ALG\_PLATFORM }\textcolor{comment}{// identify if the compilation is for ProsoftSystems IDE}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#include "{}cmath"{}}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#include "{}math.h"{}}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{preprocessor}{\#define DEBUG}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{preprocessor}{\#include "{}buffer.h"{}}}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#include "{}complex.h"{}}}
\DoxyCodeLine{56 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{special__functions_8h}{special\_functions.h}}"{}}}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{preprocessor}{\#ifndef \_\_fx32}}
\DoxyCodeLine{59 \textcolor{preprocessor}{\#define \_\_fx32 float}}
\DoxyCodeLine{60 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{preprocessor}{\#ifndef \_\_fx64}}
\DoxyCodeLine{63 \textcolor{preprocessor}{\#define \_\_fx64 double}}
\DoxyCodeLine{64 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{preprocessor}{\#ifndef \_\_fxx64}}
\DoxyCodeLine{67 \textcolor{preprocessor}{\#define \_\_fxx64 long double}}
\DoxyCodeLine{68 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{preprocessor}{\#ifndef \_\_ix32}}
\DoxyCodeLine{71 \textcolor{preprocessor}{\#define \_\_ix32 int}}
\DoxyCodeLine{72 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74 \textcolor{comment}{// customized PI:}}
\DoxyCodeLine{75 \textcolor{preprocessor}{\#ifndef PI0}}
\DoxyCodeLine{76 \textcolor{preprocessor}{\#define PI0 3.1415926535897932384626433832795}}
\DoxyCodeLine{77 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79 \textcolor{preprocessor}{\#ifndef PI2}}
\DoxyCodeLine{80 \textcolor{preprocessor}{\#define PI2 6.283185307179586476925286766559}}
\DoxyCodeLine{81 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{comment}{// IIR template zeros / poles data structure:}}
\DoxyCodeLine{84 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__zp}{iir\_zp}};}
\DoxyCodeLine{85 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__zp}{iir\_zp}}< \mbox{\hyperlink{special__functions_8h_abc3e3e3fbdd4de8d12c8a8e4057be945}{\_\_fx32}}  > \{ \mbox{\hyperlink{classcomplex}{complex< \_\_fx32  >}} *plp , *zlp , *glp; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L , R , N; \};}
\DoxyCodeLine{86 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__zp}{iir\_zp}}< \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}}  > \{ \mbox{\hyperlink{classcomplex}{complex< \_\_fx64  >}} *plp , *zlp , *glp; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L , R , N; \};}
\DoxyCodeLine{87 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__zp}{iir\_zp}}< \mbox{\hyperlink{special__functions_8h_a3aacdef884931407dac0c8d6208e647b}{\_\_fxx64}} > \{ \mbox{\hyperlink{classcomplex}{complex< \_\_fxx64 >}} *plp , *zlp , *glp; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L , R , N; \};}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{comment}{// IIR template coefficients and gains data structure:}}
\DoxyCodeLine{90 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__cf}{iir\_cf}};}
\DoxyCodeLine{91 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__cf}{iir\_cf}}< \mbox{\hyperlink{special__functions_8h_abc3e3e3fbdd4de8d12c8a8e4057be945}{\_\_fx32}}  > \{ \mbox{\hyperlink{special__functions_8h_abc3e3e3fbdd4de8d12c8a8e4057be945}{\_\_fx32}}  *cfnum , *cfden , *gains; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L , R , N; \};}
\DoxyCodeLine{92 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__cf}{iir\_cf}}< \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}}  > \{ \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}}  *cfnum , *cfden , *gains; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L , R , N; \};}
\DoxyCodeLine{93 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__cf}{iir\_cf}}< \mbox{\hyperlink{special__functions_8h_a3aacdef884931407dac0c8d6208e647b}{\_\_fxx64}} > \{ \mbox{\hyperlink{special__functions_8h_a3aacdef884931407dac0c8d6208e647b}{\_\_fxx64}} *cfnum , *cfden , *gains; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L , R , N; \};}
\DoxyCodeLine{94 }
\DoxyCodeLine{95 \textcolor{comment}{// IIR template buffers data structure:}}
\DoxyCodeLine{96 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__bf}{iir\_bf}};}
\DoxyCodeLine{97 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__bf}{iir\_bf}}< \mbox{\hyperlink{special__functions_8h_abc3e3e3fbdd4de8d12c8a8e4057be945}{\_\_fx32}}  >\{ \mbox{\hyperlink{classmirror__ring__buffer_3_01____fx32_01_4}{mirror\_ring\_buffer< \_\_fx32  >}} *bx , *by; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} N; \};}
\DoxyCodeLine{98 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__bf}{iir\_bf}}< \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}}  >\{ \mbox{\hyperlink{classmirror__ring__buffer_3_01____fx64_01_4}{mirror\_ring\_buffer< \_\_fx64  >}} *bx , *by; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} N; \};}
\DoxyCodeLine{99 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__bf}{iir\_bf}}< \mbox{\hyperlink{special__functions_8h_a3aacdef884931407dac0c8d6208e647b}{\_\_fxx64}} >\{ \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer< \_\_fxx64 >}} *bx , *by; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} N; \};}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{comment}{// IIR template frequency response data structure:}}
\DoxyCodeLine{102 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__fr}{iir\_fr}};}
\DoxyCodeLine{103 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__fr}{iir\_fr}}< \mbox{\hyperlink{special__functions_8h_abc3e3e3fbdd4de8d12c8a8e4057be945}{\_\_fx32}}  > \{ \mbox{\hyperlink{special__functions_8h_abc3e3e3fbdd4de8d12c8a8e4057be945}{\_\_fx32}}  Km , pH; \};}
\DoxyCodeLine{104 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__fr}{iir\_fr}}< \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}}  > \{ \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}}  Km , pH; \};}
\DoxyCodeLine{105 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__fr}{iir\_fr}}< \mbox{\hyperlink{special__functions_8h_a3aacdef884931407dac0c8d6208e647b}{\_\_fxx64}} > \{ \mbox{\hyperlink{special__functions_8h_a3aacdef884931407dac0c8d6208e647b}{\_\_fxx64}} Km , pH; \};}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{comment}{// IIR specification data structure:}}
\DoxyCodeLine{108 \textcolor{keyword}{struct }\mbox{\hyperlink{structiir__sp}{iir\_sp}} \{ \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , Ts , Fn , Fc , BW , Gs , Gp; \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , type; \};}
\DoxyCodeLine{109 }
\DoxyCodeLine{110 \textcolor{comment}{// IIR ZEROS / POLES PLAIN COMPUTATION FUNCTIONS:}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112 \textcolor{comment}{// Butterworth lowpass analogue normalized zeros/poles plain computation:}}
\DoxyCodeLine{113 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} \_\_butt\_zeros\_poles\_plain\_\_ ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop )}
\DoxyCodeLine{114 \{}
\DoxyCodeLine{115     \textcolor{comment}{// number of zeros, poles, coeffs:}}
\DoxyCodeLine{116     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = trunc( order / 2 ) , R = order -\/ 2 * L , N = L + R;}
\DoxyCodeLine{117 }
\DoxyCodeLine{118     \textcolor{comment}{// stopband attenuation:}}
\DoxyCodeLine{119     T epsilon\_stop = sqrt(pow(10, g\_stop / 10) -\/ 1);}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{comment}{// memory allocation for the lowpass analogue prototype poles, zeros and gains:}}
\DoxyCodeLine{122     \mbox{\hyperlink{classcomplex}{complex<T>}} *plp = ( \mbox{\hyperlink{classcomplex}{complex<T>}}* ) calloc( N+0 , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex<T>}} ) );}
\DoxyCodeLine{123     \mbox{\hyperlink{classcomplex}{complex<T>}} *zlp = ( \mbox{\hyperlink{classcomplex}{complex<T>}}* ) calloc( N+0 , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex<T>}} ) );}
\DoxyCodeLine{124     \mbox{\hyperlink{classcomplex}{complex<T>}} *glp = ( \mbox{\hyperlink{classcomplex}{complex<T>}}* ) calloc( N+1 , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex<T>}} ) );}
\DoxyCodeLine{125 }
\DoxyCodeLine{126     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__zp}{iir\_zp<T>}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{127 }
\DoxyCodeLine{128     \textcolor{comment}{// complex-\/conjugate pairs:}}
\DoxyCodeLine{129     T alpha = 0 , betta = 1 / sqrt( pow( epsilon\_stop , 1 / order ) );}
\DoxyCodeLine{130 }
\DoxyCodeLine{131     \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < L ; i++ )}
\DoxyCodeLine{132     \{}
\DoxyCodeLine{133         alpha = (2 * (i + 1) -\/ 1) * \mbox{\hyperlink{special__functions_8h_a6eaf18f28b8bcd8aa3e36d0e307afa0e}{PI0}} / (2 * order);}
\DoxyCodeLine{134         plp[i] = \mbox{\hyperlink{classcomplex}{complex<T>}}( ( -\/1 / betta * sin(alpha) ) , ( +1 / betta * cos(alpha) ) );}
\DoxyCodeLine{135         glp[i] = plp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) ;}
\DoxyCodeLine{136     \}}
\DoxyCodeLine{137 }
\DoxyCodeLine{138     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{139     \textcolor{keywordflow}{if}( R == 1 )}
\DoxyCodeLine{140     \{}
\DoxyCodeLine{141         plp[ N -\/ 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( ( -\/1 / betta ) , 0 );}
\DoxyCodeLine{142         glp[ N -\/ 1 ] = -\/plp[ N -\/ 1 ].m\_re;}
\DoxyCodeLine{143     \}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145     \textcolor{comment}{// setting the output gain:}}
\DoxyCodeLine{146     glp[ N ] = 1;}
\DoxyCodeLine{147 }
\DoxyCodeLine{148     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} \{ plp , zlp , glp , L , R , N \};}
\DoxyCodeLine{149 \}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151 \textcolor{comment}{// Chebyshev type I lowpass analogue normalized zeros/poles plain computation:}}
\DoxyCodeLine{152 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} \_\_cheb1\_zeros\_poles\_plain\_\_( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop )}
\DoxyCodeLine{153 \{}
\DoxyCodeLine{154     \textcolor{comment}{// number of zeros, poles, coeffs:}}
\DoxyCodeLine{155     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = trunc( order / 2 ) , R = order -\/ 2 * L , N = L + R;}
\DoxyCodeLine{156 }
\DoxyCodeLine{157     \textcolor{comment}{// stopband attenuation:}}
\DoxyCodeLine{158     T epsilon\_stop = sqrt(pow(10, g\_stop / 10) -\/ 1);}
\DoxyCodeLine{159 }
\DoxyCodeLine{160     \textcolor{comment}{// memory allocation for the lowpass analogue prototype poles, zeros and gains:}}
\DoxyCodeLine{161     \mbox{\hyperlink{classcomplex}{complex< T >}}  *plp = ( \mbox{\hyperlink{classcomplex}{complex<T>}}* ) calloc( N   , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{162     \mbox{\hyperlink{classcomplex}{complex< T >}}  *zlp = ( \mbox{\hyperlink{classcomplex}{complex<T>}}* ) calloc( N   , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{163     \mbox{\hyperlink{classcomplex}{complex< T >}}  *glp = ( \mbox{\hyperlink{classcomplex}{complex<T>}}* ) calloc( N+1 , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{164 }
\DoxyCodeLine{165     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{166 }
\DoxyCodeLine{167     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{168     T alpha = 0 , betta = asinh( 1 / epsilon\_stop ) / order;}
\DoxyCodeLine{169     \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0; i < L; i++)}
\DoxyCodeLine{170     \{}
\DoxyCodeLine{171         alpha = (2 * (i + 1) -\/ 1) * \mbox{\hyperlink{special__functions_8h_a6eaf18f28b8bcd8aa3e36d0e307afa0e}{PI0}} / (2 * order);}
\DoxyCodeLine{172         plp[i] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/sin( alpha ) * sinh( betta ) , +cos( alpha ) * cosh( betta ) );}
\DoxyCodeLine{173         glp[i] = plp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] );}
\DoxyCodeLine{174     \}}
\DoxyCodeLine{175 }
\DoxyCodeLine{176     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{177     \textcolor{keywordflow}{if} ( R == 1 )}
\DoxyCodeLine{178     \{}
\DoxyCodeLine{179         plp[ N -\/ 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/sinh( betta ) , 0 );}
\DoxyCodeLine{180         glp[ N -\/ 1 ] = -\/plp[ N -\/ 1 ].m\_re;}
\DoxyCodeLine{181     \}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183     \textcolor{comment}{// setting the output gain:}}
\DoxyCodeLine{184     glp[N] = ( R < 1 ) ? ( sqrt(1 / (1 + epsilon\_stop * epsilon\_stop) ) ) : 1;}
\DoxyCodeLine{185 }
\DoxyCodeLine{186     \textcolor{comment}{// end the computation and return the filter info:}}
\DoxyCodeLine{187     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}}\{ plp , zlp , glp , L , R , N \};}
\DoxyCodeLine{188 \}}
\DoxyCodeLine{189 }
\DoxyCodeLine{190 \textcolor{comment}{// Chebyshev type II lowpass analogue normalized zeros/poles plain computation:}}
\DoxyCodeLine{191 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} \_\_cheb2\_zeros\_poles\_plain\_\_( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop )}
\DoxyCodeLine{192 \{}
\DoxyCodeLine{193     \textcolor{comment}{// INITIALIZATION:}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195     \textcolor{comment}{// stopband attenuation:}}
\DoxyCodeLine{196     \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} epsilon\_stop = sqrt(pow(10, g\_stop / 10) -\/ 1);}
\DoxyCodeLine{197 }
\DoxyCodeLine{198     \textcolor{comment}{// identify the number of zeros and poles:}}
\DoxyCodeLine{199     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = trunc( order / 2 ) , R = order -\/ 2 * L , N = L + R;}
\DoxyCodeLine{200 }
\DoxyCodeLine{201     \textcolor{comment}{// allocate zeros and poles arrays:}}
\DoxyCodeLine{202     \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( N   , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{203     \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( N   , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{204     \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( N+1 , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{205 }
\DoxyCodeLine{206     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{207 }
\DoxyCodeLine{208     \textcolor{comment}{// ZEROS AND POLES COMPUTATION:}}
\DoxyCodeLine{209 }
\DoxyCodeLine{210     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{211 }
\DoxyCodeLine{212     \textcolor{comment}{// auxiliary variables:}}
\DoxyCodeLine{213     T alpha , betta = asinh( epsilon\_stop ) / order , re , im;}
\DoxyCodeLine{214 }
\DoxyCodeLine{215     \textcolor{comment}{// zeros , poles, gains computation:}}
\DoxyCodeLine{216     \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < L ; i++ )}
\DoxyCodeLine{217     \{}
\DoxyCodeLine{218         alpha = (2 * ( i + 1 ) -\/ 1) * \mbox{\hyperlink{special__functions_8h_a6eaf18f28b8bcd8aa3e36d0e307afa0e}{PI0}} / ( 2 * order );}
\DoxyCodeLine{219 }
\DoxyCodeLine{220         \textcolor{comment}{// zeros:}}
\DoxyCodeLine{221         zlp[i] = \mbox{\hyperlink{classcomplex}{complex< T >}}( 0 , 1 / cos( alpha ) );}
\DoxyCodeLine{222 }
\DoxyCodeLine{223         \textcolor{comment}{// poles:}}
\DoxyCodeLine{224         re = -\/( sin( alpha ) * sinh( betta ) ) / ( cos( alpha ) * cos( alpha ) * cosh( betta ) * cosh( betta ) + sin( alpha ) * sin( alpha ) * sinh( betta ) * sinh( betta ) );}
\DoxyCodeLine{225         im = +( cos( alpha ) * cosh( betta ) ) / ( cos( alpha ) * cos( alpha ) * cosh( betta ) * cosh( betta ) + sin( alpha ) * sin( alpha ) * sinh( betta ) * sinh( betta ) );}
\DoxyCodeLine{226         plp[i] = \mbox{\hyperlink{classcomplex}{complex< T >}}( re , im );}
\DoxyCodeLine{227 }
\DoxyCodeLine{228         \textcolor{comment}{// gains:}}
\DoxyCodeLine{229         glp[i] = ( zlp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zlp[i] ) ) / ( plp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) );}
\DoxyCodeLine{230         glp[i] = \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) / glp[i];}
\DoxyCodeLine{231     \}}
\DoxyCodeLine{232 }
\DoxyCodeLine{233     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{234     \textcolor{keywordflow}{if}( R >= 1 )}
\DoxyCodeLine{235     \{}
\DoxyCodeLine{236         plp[ N -\/ 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 / sinh( betta ) , 0 );}
\DoxyCodeLine{237         glp[ N -\/ 1 ] = -\/plp[N-\/1].m\_re;}
\DoxyCodeLine{238     \}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240     \textcolor{comment}{// set the output gain:}}
\DoxyCodeLine{241     glp[N] = 1;}
\DoxyCodeLine{242 }
\DoxyCodeLine{243     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}}\{ plp , zlp , glp , L , R , N \};}
\DoxyCodeLine{244 \}}
\DoxyCodeLine{245 }
\DoxyCodeLine{246 \textcolor{comment}{// Elliptic lowpass analogue normalized zeros/poles plain computation:}}
\DoxyCodeLine{247 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} \_\_ellip\_zeros\_poles\_plain\_\_( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order ,  \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_pass , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop )}
\DoxyCodeLine{248 \{}
\DoxyCodeLine{249     \textcolor{comment}{// INITIALIZATION:}}
\DoxyCodeLine{250 }
\DoxyCodeLine{251     \textcolor{comment}{// stopband and passband attenuation:}}
\DoxyCodeLine{252     \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} epsilon\_stop = sqrt(pow(10, g\_stop / 10) -\/ 1);}
\DoxyCodeLine{253     \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} epsilon\_pass = sqrt(pow(10, g\_pass / 10) -\/ 1);}
\DoxyCodeLine{254 }
\DoxyCodeLine{255     \textcolor{comment}{// identify the number of zeros and poles:}}
\DoxyCodeLine{256     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = trunc( order / 2 ) , R = order -\/ 2 * L , N = L + R;}
\DoxyCodeLine{257 }
\DoxyCodeLine{258     \textcolor{comment}{// allocate zeros and poles arrays:}}
\DoxyCodeLine{259     \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( N   , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{260     \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( N   , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{261     \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( N+1 , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{262 }
\DoxyCodeLine{263     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{264 }
\DoxyCodeLine{265     \textcolor{comment}{// TRANSIENT SUPPRESSION FACTORS COMPUTATION:}}
\DoxyCodeLine{266 }
\DoxyCodeLine{267     \textcolor{comment}{// auxiliary variables:}}
\DoxyCodeLine{268     T SN , KE;}
\DoxyCodeLine{269     T Ke = epsilon\_pass / epsilon\_stop , Kp = 1;}
\DoxyCodeLine{270     T m = sqrt( 1 -\/ Ke * Ke ) , alpha , Kw;}
\DoxyCodeLine{271 }
\DoxyCodeLine{272     \textcolor{comment}{// transient suppression factors computation:}}
\DoxyCodeLine{273     \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0; i < L; i++ )}
\DoxyCodeLine{274     \{}
\DoxyCodeLine{275         alpha = (2 * ( i + 1 ) -\/ 1) / ( ( T )order);}
\DoxyCodeLine{276         KE = \mbox{\hyperlink{special__functions_8h_a3fa06fe8d85507b8ee533ab4794902f6}{\_\_ellip\_k\_\_}}( m );}
\DoxyCodeLine{277         SN = \mbox{\hyperlink{special__functions_8h_a73f108269c4fe5a4fc7084d663a54920}{\_\_sn\_\_}}( alpha * KE , m );}
\DoxyCodeLine{278         Kp = Kp * SN*SN*SN*SN;}
\DoxyCodeLine{279     \}}
\DoxyCodeLine{280 }
\DoxyCodeLine{281     Kp = pow( m , order) * Kp;}
\DoxyCodeLine{282     Kw = sqrt(1 -\/ Kp * Kp);}
\DoxyCodeLine{283 }
\DoxyCodeLine{284     \textcolor{comment}{// ZEROS COMPUTATION:}}
\DoxyCodeLine{285 }
\DoxyCodeLine{286     KE = \mbox{\hyperlink{special__functions_8h_a3fa06fe8d85507b8ee533ab4794902f6}{\_\_ellip\_k\_\_}}( Kw );}
\DoxyCodeLine{287     \textcolor{keywordflow}{if}( order \% 2 == 0 ) \textcolor{comment}{// even order filter}}
\DoxyCodeLine{288     \{}
\DoxyCodeLine{289         \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0; i < L; i++)}
\DoxyCodeLine{290         \{}
\DoxyCodeLine{291             alpha = (2 * i + 1) / ( ( T )order) * KE;}
\DoxyCodeLine{292             SN = \mbox{\hyperlink{special__functions_8h_a73f108269c4fe5a4fc7084d663a54920}{\_\_sn\_\_}}( alpha , Kw );}
\DoxyCodeLine{293             zlp[i] = \mbox{\hyperlink{classcomplex}{complex< T >}}( 0 , 1 /( Kw * SN ) );}
\DoxyCodeLine{294         \}}
\DoxyCodeLine{295     \}}
\DoxyCodeLine{296     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( order \% 2 != 0 ) \textcolor{comment}{// odd order filter}}
\DoxyCodeLine{297     \{}
\DoxyCodeLine{298         \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0; i < L; i++)}
\DoxyCodeLine{299         \{}
\DoxyCodeLine{300             alpha = (2 * i + 2) / ( ( T )order) * KE;}
\DoxyCodeLine{301             SN = \mbox{\hyperlink{special__functions_8h_a73f108269c4fe5a4fc7084d663a54920}{\_\_sn\_\_}}( alpha , Kw );}
\DoxyCodeLine{302             zlp[i] = \mbox{\hyperlink{classcomplex}{complex< T >}}( 0 , 1 /( Kw * SN ) );}
\DoxyCodeLine{303         \}}
\DoxyCodeLine{304     \}}
\DoxyCodeLine{305 }
\DoxyCodeLine{306     \textcolor{comment}{// POLES COMPUTATION:}}
\DoxyCodeLine{307     T V0 = 0 , A = 0 , B = 0 , C = 0 , D = 0 , E = 0 , F = 0;}
\DoxyCodeLine{308     V0 = -\/\mbox{\hyperlink{special__functions_8h_a3fa06fe8d85507b8ee533ab4794902f6}{\_\_ellip\_k\_\_}}( Kw ) * \mbox{\hyperlink{special__functions_8h_ac134d47fba3ac51f40bf5b5f363c14b1}{\_\_isc\_\_}}(1 / epsilon\_pass, sqrt(1 -\/ Ke * Ke)) / ( \mbox{\hyperlink{special__functions_8h_a3fa06fe8d85507b8ee533ab4794902f6}{\_\_ellip\_k\_\_}}( Ke ) * ( ( T ) order ) );}
\DoxyCodeLine{309     KE =  \mbox{\hyperlink{special__functions_8h_a3fa06fe8d85507b8ee533ab4794902f6}{\_\_ellip\_k\_\_}}( Kw );}
\DoxyCodeLine{310 }
\DoxyCodeLine{311     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{312     \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0; i < L; i++)}
\DoxyCodeLine{313     \{}
\DoxyCodeLine{314         \textcolor{keywordflow}{if}( order \% 2 == 0 ) \textcolor{comment}{// even order filter}}
\DoxyCodeLine{315         \{}
\DoxyCodeLine{316             alpha = (2 * i + 1) / ( ( T ) order ) * KE;}
\DoxyCodeLine{317         \}}
\DoxyCodeLine{318         \textcolor{keywordflow}{else} \textcolor{comment}{// odd order filter}}
\DoxyCodeLine{319         \{}
\DoxyCodeLine{320             alpha = (2 * i + 2) / ( ( T ) order ) * KE;}
\DoxyCodeLine{321         \}}
\DoxyCodeLine{322 }
\DoxyCodeLine{323         \textcolor{comment}{// compute auxiliary variables:}}
\DoxyCodeLine{324         A = \mbox{\hyperlink{special__functions_8h_a852068c36a4bce93e885484a85f154bf}{\_\_cn\_\_}}( alpha , Kw );}
\DoxyCodeLine{325         B = \mbox{\hyperlink{special__functions_8h_a9f49e0deb7335a6c82defffdbd19918e}{\_\_dn\_\_}}( alpha , Kw );}
\DoxyCodeLine{326         C = \mbox{\hyperlink{special__functions_8h_a73f108269c4fe5a4fc7084d663a54920}{\_\_sn\_\_}}( V0, sqrt( 1 -\/ Kw * Kw));}
\DoxyCodeLine{327         D = sqrt(1 -\/ C * C);}
\DoxyCodeLine{328         E = B * B;}
\DoxyCodeLine{329         F = C * C;}
\DoxyCodeLine{330 }
\DoxyCodeLine{331         \textcolor{comment}{// pole real part:}}
\DoxyCodeLine{332         plp[i].m\_re = A * B * C * D / (1 -\/ E * F);}
\DoxyCodeLine{333 }
\DoxyCodeLine{334         \textcolor{comment}{// compute auxiliary variables:}}
\DoxyCodeLine{335         A = \mbox{\hyperlink{special__functions_8h_a73f108269c4fe5a4fc7084d663a54920}{\_\_sn\_\_}}( alpha, Kw );}
\DoxyCodeLine{336         B = \mbox{\hyperlink{special__functions_8h_a9f49e0deb7335a6c82defffdbd19918e}{\_\_dn\_\_}}( V0 , sqrt(1 -\/ Kw * Kw ) );}
\DoxyCodeLine{337         C = \mbox{\hyperlink{special__functions_8h_a9f49e0deb7335a6c82defffdbd19918e}{\_\_dn\_\_}}( alpha, Kw );}
\DoxyCodeLine{338         D = \mbox{\hyperlink{special__functions_8h_a73f108269c4fe5a4fc7084d663a54920}{\_\_sn\_\_}}( V0, sqrt( 1 -\/ Kw * Kw ) );}
\DoxyCodeLine{339         E = C * C;}
\DoxyCodeLine{340         F = D * D;}
\DoxyCodeLine{341 }
\DoxyCodeLine{342         \textcolor{comment}{// pole imaginary part:}}
\DoxyCodeLine{343         plp[i].m\_im = A * B / (1 -\/ E * F);}
\DoxyCodeLine{344     \}}
\DoxyCodeLine{345 }
\DoxyCodeLine{346     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{347     \textcolor{keywordflow}{if}( R >= 1 )}
\DoxyCodeLine{348     \{}
\DoxyCodeLine{349         \textcolor{comment}{// compute auxiliary variables:}}
\DoxyCodeLine{350         A = \mbox{\hyperlink{special__functions_8h_a73f108269c4fe5a4fc7084d663a54920}{\_\_sn\_\_}}( V0 , sqrt( 1 -\/ Kw * Kw ) );}
\DoxyCodeLine{351         B = \mbox{\hyperlink{special__functions_8h_a852068c36a4bce93e885484a85f154bf}{\_\_cn\_\_}}( V0 , sqrt( 1 -\/ Kw * Kw ) );}
\DoxyCodeLine{352         C = A * A;}
\DoxyCodeLine{353 }
\DoxyCodeLine{354         \textcolor{comment}{// compute the real odd pole:}}
\DoxyCodeLine{355         plp[ N -\/ 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( A * B / ( 1 -\/ C )  , 0 );}
\DoxyCodeLine{356     \}}
\DoxyCodeLine{357 }
\DoxyCodeLine{358     \textcolor{comment}{// GAINS COMPUTATION:}}
\DoxyCodeLine{359 }
\DoxyCodeLine{360     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{361     \textcolor{keywordflow}{if}( R >= 1 )}
\DoxyCodeLine{362     \{}
\DoxyCodeLine{363         \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{364         \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0; i < L; i++)}
\DoxyCodeLine{365         \{}
\DoxyCodeLine{366             glp[i] = ( zlp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zlp[i] ) ) / ( plp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) );}
\DoxyCodeLine{367             glp[i] = \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) / glp[i];}
\DoxyCodeLine{368         \}}
\DoxyCodeLine{369 }
\DoxyCodeLine{370         \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{371         glp[ N -\/ 1 ] = -\/plp[ N -\/ 1 ].m\_re;}
\DoxyCodeLine{372 }
\DoxyCodeLine{373         \textcolor{comment}{// output gain:}}
\DoxyCodeLine{374         glp[N] = 1;}
\DoxyCodeLine{375     \}}
\DoxyCodeLine{376     \textcolor{keywordflow}{else}}
\DoxyCodeLine{377     \{}
\DoxyCodeLine{378         T a = sqrt( 1 / (1 + epsilon\_stop * epsilon\_stop) );}
\DoxyCodeLine{379         glp[N] = pow ( a , 1 / ( ( T ) L ) );}
\DoxyCodeLine{380         \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0; i < L; i++) glp[i] = glp[N];}
\DoxyCodeLine{381     \}}
\DoxyCodeLine{382 }
\DoxyCodeLine{383     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}}\{ plp , zlp , glp , L , R , N \};}
\DoxyCodeLine{384 \}}
\DoxyCodeLine{385 }
\DoxyCodeLine{386 \textcolor{comment}{// UNIT NUMERATOR IIR COEFFICIENTS COMPUTATION:}}
\DoxyCodeLine{387 }
\DoxyCodeLine{388 \textcolor{comment}{// Butterworth or Chebyshev I digital lowpass coefficients computation:}}
\DoxyCodeLine{389 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}} \_\_butt\_cheb1\_digital\_lp\_\_( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} type = 0 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop = 1 )}
\DoxyCodeLine{390 \{}
\DoxyCodeLine{391     \textcolor{comment}{// Fs           -\/ sampling frequency}}
\DoxyCodeLine{392     \textcolor{comment}{// Fstop        -\/ cutoff frequency}}
\DoxyCodeLine{393     \textcolor{comment}{// order        -\/ filter order}}
\DoxyCodeLine{394     \textcolor{comment}{// coeffs\_num   -\/ quadratic sections numerator coefficients}}
\DoxyCodeLine{395     \textcolor{comment}{// coeffs\_den   -\/ quadratic sections denominator coefficients}}
\DoxyCodeLine{396     \textcolor{comment}{// gains        -\/ quadratic sections gains}}
\DoxyCodeLine{397     \textcolor{comment}{// type         -\/ filter type ( 0 -\/ Butterworth , 1 -\/ Chebyshev )}}
\DoxyCodeLine{398     \textcolor{comment}{// g\_stop       -\/ stopband attenuation in Db}}
\DoxyCodeLine{399 }
\DoxyCodeLine{400     \textcolor{comment}{// COMPUTE LOWPASS ANALOGUE PROTOTYPE ZEROS, POLES AND GAINS:}}
\DoxyCodeLine{401     \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} zp = ( !type ) ? \_\_butt\_zeros\_poles\_plain\_\_< T >( order , g\_stop ) : \_\_cheb1\_zeros\_poles\_plain\_\_< T >( order , g\_stop );}
\DoxyCodeLine{402 }
\DoxyCodeLine{403     \textcolor{comment}{// allocate zeros and poles arrays:}}
\DoxyCodeLine{404     \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = zp.plp;}
\DoxyCodeLine{405     \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = zp.zlp;}
\DoxyCodeLine{406     \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = zp.glp;}
\DoxyCodeLine{407     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = zp.L , R = zp.R , N = L + R;}
\DoxyCodeLine{408 }
\DoxyCodeLine{409     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{410 }
\DoxyCodeLine{411     \textcolor{comment}{// frequency deformation coefficient:}}
\DoxyCodeLine{412     T K = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * Fc / 2 / Fs );}
\DoxyCodeLine{413 }
\DoxyCodeLine{414     \textcolor{comment}{// coefficients matrix computation:}}
\DoxyCodeLine{415     T *cfnum = ( T* )calloc( 3 * N , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{416     T *cfden = ( T* )calloc( 3 * N , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{417     T *gains = ( T* )calloc( N + 1 , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{418 }
\DoxyCodeLine{419     \textcolor{keywordflow}{if}( cfnum == 0 || cfden == 0 || gains == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{420 }
\DoxyCodeLine{421     \textcolor{comment}{// BILLINEAR LP-\/LP TRANSFORM:}}
\DoxyCodeLine{422 }
\DoxyCodeLine{423     \textcolor{comment}{// complex-\/conjugate pairs:}}
\DoxyCodeLine{424     \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < L ; i++ )}
\DoxyCodeLine{425     \{}
\DoxyCodeLine{426         \textcolor{comment}{// quadratic section gain:}}
\DoxyCodeLine{427         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[i];}
\DoxyCodeLine{428         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = \mbox{\hyperlink{classcomplex}{complex< T >}}( K * K , 0 );}
\DoxyCodeLine{429         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[i] * K ) * ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) * K );}
\DoxyCodeLine{430         gains[i] = ( gain0 * gain1 / gain2 ).m\_re;}
\DoxyCodeLine{431 }
\DoxyCodeLine{432         \textcolor{comment}{// zeros and poles transformation:}}
\DoxyCodeLine{433         zlp[i] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{434         plp[i] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + plp[i] * K ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[i] * K );}
\DoxyCodeLine{435 }
\DoxyCodeLine{436         \textcolor{comment}{// quadratic section numerator coefficients:}}
\DoxyCodeLine{437         cfnum[ 3 * i + 0 ] = +1;}
\DoxyCodeLine{438         cfnum[ 3 * i + 1 ] = +2;}
\DoxyCodeLine{439         cfnum[ 3 * i + 2 ] = +1;}
\DoxyCodeLine{440 }
\DoxyCodeLine{441         \textcolor{comment}{// quadratic section denumerator coefficients:}}
\DoxyCodeLine{442         cfden[ 3 * i + 0 ] = 1;}
\DoxyCodeLine{443         cfden[ 3 * i + 1 ] = -\/( plp[i] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) ).m\_re;}
\DoxyCodeLine{444         cfden[ 3 * i + 2 ] = +( plp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) ).m\_re;}
\DoxyCodeLine{445     \}}
\DoxyCodeLine{446 }
\DoxyCodeLine{447     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{448     \textcolor{keywordflow}{if} ( R == 1 )}
\DoxyCodeLine{449     \{}
\DoxyCodeLine{450         \textcolor{comment}{// quadratic section gain:}}
\DoxyCodeLine{451         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[N-\/1];}
\DoxyCodeLine{452         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = \mbox{\hyperlink{classcomplex}{complex< T >}}( K , 0 );}
\DoxyCodeLine{453         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[N-\/1] * K );}
\DoxyCodeLine{454         gains[N-\/1] = ( gain0 * gain1 / gain2 ).m\_re;}
\DoxyCodeLine{455 }
\DoxyCodeLine{456         \textcolor{comment}{// zeros and poles transformation:}}
\DoxyCodeLine{457         zlp[ N -\/ 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{458         plp[ N -\/ 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + plp[N-\/1] * K ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[N-\/1] * K );}
\DoxyCodeLine{459 }
\DoxyCodeLine{460         \textcolor{comment}{// real odd pole section coefficients computation:}}
\DoxyCodeLine{461 }
\DoxyCodeLine{462         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{463         cfnum[ 3 * ( N -\/ 1 ) + 0 ] = 1;}
\DoxyCodeLine{464         cfnum[ 3 * ( N -\/ 1 ) + 1 ] = -\/ zlp[ N -\/ 1 ].m\_re;}
\DoxyCodeLine{465         cfnum[ 3 * ( N -\/ 1 ) + 2 ] = 0;}
\DoxyCodeLine{466 }
\DoxyCodeLine{467         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{468         cfden[ 3 * ( N -\/ 1 ) + 0 ] = 1;}
\DoxyCodeLine{469         cfden[ 3 * ( N -\/ 1 ) + 1 ] = -\/plp[N-\/1].m\_re;}
\DoxyCodeLine{470         cfden[ 3 * ( N -\/ 1 ) + 2 ] = 0;}
\DoxyCodeLine{471     \}}
\DoxyCodeLine{472 }
\DoxyCodeLine{473     \textcolor{comment}{// setting filter output gain:}}
\DoxyCodeLine{474     gains[N] = glp[N].m\_re;}
\DoxyCodeLine{475 }
\DoxyCodeLine{476 }
\DoxyCodeLine{477     \textcolor{comment}{// memory free:}}
\DoxyCodeLine{478     free( plp  );}
\DoxyCodeLine{479     free( zlp  );}
\DoxyCodeLine{480     free( glp  );}
\DoxyCodeLine{481 }
\DoxyCodeLine{482     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ cfnum , cfden , gains , L , R , N \};}
\DoxyCodeLine{483 \}}
\DoxyCodeLine{484 }
\DoxyCodeLine{485 \textcolor{comment}{// Butterworth or Chebyshev I digital highpass coefficients computation:}}
\DoxyCodeLine{486 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}} \_\_butt\_cheb1\_digital\_hp\_\_( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fp , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} type = 0 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop = 1 )}
\DoxyCodeLine{487 \{}
\DoxyCodeLine{488     \textcolor{comment}{// Fs           -\/ sampling frequency}}
\DoxyCodeLine{489     \textcolor{comment}{// Fpass        -\/ cutoff frequency}}
\DoxyCodeLine{490     \textcolor{comment}{// order        -\/ filter order}}
\DoxyCodeLine{491     \textcolor{comment}{// coeffs\_num   -\/ quadratic sections numerator coefficients}}
\DoxyCodeLine{492     \textcolor{comment}{// coeffs\_den   -\/ quadratic sections denominator coefficients}}
\DoxyCodeLine{493     \textcolor{comment}{// gains        -\/ quadratic sections gains}}
\DoxyCodeLine{494     \textcolor{comment}{// type         -\/ filter type ( 0 -\/ Butterworth , 1 -\/ Chebyshev )}}
\DoxyCodeLine{495     \textcolor{comment}{// g\_stop       -\/ stopband attenuation in Db}}
\DoxyCodeLine{496 }
\DoxyCodeLine{497     \textcolor{comment}{// INITIALIZATION:}}
\DoxyCodeLine{498     \mbox{\hyperlink{structiir__zp}{iir\_zp < T >}} zp = ( !type ) ? \_\_butt\_zeros\_poles\_plain\_\_< T >( order , g\_stop ) : \_\_cheb1\_zeros\_poles\_plain\_\_< T >( order , g\_stop );}
\DoxyCodeLine{499     \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = zp.plp;}
\DoxyCodeLine{500     \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = zp.zlp;}
\DoxyCodeLine{501     \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = zp.glp;}
\DoxyCodeLine{502     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = zp.L , R = zp.R , N = L + R;}
\DoxyCodeLine{503 }
\DoxyCodeLine{504     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{505 }
\DoxyCodeLine{506     \textcolor{comment}{// frequency deformation coefficient:}}
\DoxyCodeLine{507     T w = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * Fp / 2 / Fs );}
\DoxyCodeLine{508 }
\DoxyCodeLine{509     \textcolor{comment}{// coefficients matrix computation:}}
\DoxyCodeLine{510     T *cfnum = ( T* )calloc( 3 * N , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{511     T *cfden = ( T* )calloc( 3 * N , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{512     T *gains = ( T* )calloc( N + 1 , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{513 }
\DoxyCodeLine{514     \textcolor{keywordflow}{if}( cfnum == 0 || cfden == 0 || gains == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{515 }
\DoxyCodeLine{516     \textcolor{comment}{// BILLINEAR LP-\/HP TRANSFORM:}}
\DoxyCodeLine{517 }
\DoxyCodeLine{518     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{519     \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0; i < L; i++)}
\DoxyCodeLine{520     \{}
\DoxyCodeLine{521         \textcolor{comment}{// gains compputation:}}
\DoxyCodeLine{522         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[i];}
\DoxyCodeLine{523         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[i] / w ) * ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) / w );}
\DoxyCodeLine{524         gains[i] = ( gain0 / gain1 / w / w).m\_re;}
\DoxyCodeLine{525         \textcolor{comment}{//gains[i] = ( gain0 * gain0 / gain1 / w / w).m\_re;}}
\DoxyCodeLine{526 }
\DoxyCodeLine{527         \textcolor{comment}{// zeros and poles transformation:}}
\DoxyCodeLine{528         zlp[i] = \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 );}
\DoxyCodeLine{529         plp[i] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + plp[i] / w ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[i] / w ) * (-\/1);}
\DoxyCodeLine{530 }
\DoxyCodeLine{531         \textcolor{comment}{// digital highpass coefficients computation:}}
\DoxyCodeLine{532 }
\DoxyCodeLine{533         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{534         cfnum[3*i+0] = +1;}
\DoxyCodeLine{535         cfnum[3*i+1] = -\/2;}
\DoxyCodeLine{536         cfnum[3*i+2] = +1;}
\DoxyCodeLine{537 }
\DoxyCodeLine{538         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{539         cfden[3*i+0] = 1;}
\DoxyCodeLine{540         cfden[3*i+1] = -\/( plp[i] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(plp[i]) ).m\_re;}
\DoxyCodeLine{541         cfden[3*i+2] = +( plp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(plp[i]) ).m\_re;}
\DoxyCodeLine{542     \}}
\DoxyCodeLine{543 }
\DoxyCodeLine{544     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{545     \textcolor{keywordflow}{if} ( R == 1 )}
\DoxyCodeLine{546     \{}
\DoxyCodeLine{547         \textcolor{comment}{// gains compputation:}}
\DoxyCodeLine{548         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[N-\/1];}
\DoxyCodeLine{549         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[N-\/1] / w );}
\DoxyCodeLine{550         gains[N-\/1] = ( gain0 / gain1 / w ).m\_re;}
\DoxyCodeLine{551 }
\DoxyCodeLine{552         \textcolor{comment}{// zeros and poles transformation:}}
\DoxyCodeLine{553         zlp[ N -\/ 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 );}
\DoxyCodeLine{554         plp[ N -\/ 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + plp[ N -\/ 1 ] / w ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[ N -\/ 1 ] / w ) * (-\/1);}
\DoxyCodeLine{555 }
\DoxyCodeLine{556         \textcolor{comment}{// digital highpass coefficients computation:}}
\DoxyCodeLine{557 }
\DoxyCodeLine{558         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{559         cfnum[3*(N-\/1)+0] = +1;}
\DoxyCodeLine{560         cfnum[3*(N-\/1)+1] = -\/2;}
\DoxyCodeLine{561         cfnum[3*(N-\/1)+2] = +1;}
\DoxyCodeLine{562 }
\DoxyCodeLine{563         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{564         cfden[3*(N-\/1)+0] = 1;}
\DoxyCodeLine{565         cfden[3*(N-\/1)+1] = -\/plp[ N -\/ 1 ].m\_re;}
\DoxyCodeLine{566         cfden[3*(N-\/1)+2] = 0;}
\DoxyCodeLine{567     \}}
\DoxyCodeLine{568 }
\DoxyCodeLine{569     \textcolor{comment}{// setting filter output gain:}}
\DoxyCodeLine{570     gains[N] = glp[N].m\_re;}
\DoxyCodeLine{571 }
\DoxyCodeLine{572     \textcolor{comment}{// memory free:}}
\DoxyCodeLine{573     free( plp  );}
\DoxyCodeLine{574     free( zlp  );}
\DoxyCodeLine{575     free( glp  );}
\DoxyCodeLine{576 }
\DoxyCodeLine{577     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ cfnum , cfden , gains , L , R , N \};}
\DoxyCodeLine{578 \}}
\DoxyCodeLine{579 }
\DoxyCodeLine{580 \textcolor{comment}{// Butterworth or Chebyshev I digital bandpass coefficients computation:}}
\DoxyCodeLine{581 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}} \_\_butt\_cheb1\_digital\_bp\_\_( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fp , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BandWidth , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} type = 0 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop = 1 )}
\DoxyCodeLine{582 \{}
\DoxyCodeLine{583     \textcolor{comment}{// Fs           -\/ sampling frequency}}
\DoxyCodeLine{584     \textcolor{comment}{// Fpass        -\/ passband frequency}}
\DoxyCodeLine{585     \textcolor{comment}{// BandWidth    -\/ passband withd}}
\DoxyCodeLine{586     \textcolor{comment}{// order        -\/ filter order}}
\DoxyCodeLine{587     \textcolor{comment}{// coeffs\_num   -\/ quadratic sections numerator coefficients}}
\DoxyCodeLine{588     \textcolor{comment}{// coeffs\_den   -\/ quadratic sections denominator coefficients}}
\DoxyCodeLine{589     \textcolor{comment}{// gains        -\/ quadratic sections gains}}
\DoxyCodeLine{590     \textcolor{comment}{// type         -\/ filter type ( 0 -\/ Butterworth , 1 -\/ Chebyshev )}}
\DoxyCodeLine{591     \textcolor{comment}{// g\_stop       -\/ stopband attenuation in Db}}
\DoxyCodeLine{592 }
\DoxyCodeLine{593      order /= 2;}
\DoxyCodeLine{594 }
\DoxyCodeLine{595     \textcolor{comment}{// frequency deformation coefficient:}}
\DoxyCodeLine{596     T w1 = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * Fp / 2 / Fs ) , w2 = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * ( Fp + BandWidth ) / 2 / Fs );}
\DoxyCodeLine{597 }
\DoxyCodeLine{598     \textcolor{comment}{// allocate zeros and poles arrays:}}
\DoxyCodeLine{599 }
\DoxyCodeLine{600     \textcolor{comment}{// lowpass analogue prototype poles, zeros and gains:}}
\DoxyCodeLine{601     \mbox{\hyperlink{structiir__zp}{iir\_zp < T >}} zp = ( !type ) ? \_\_butt\_zeros\_poles\_plain\_\_< T >( order , g\_stop ) : \_\_cheb1\_zeros\_poles\_plain\_\_< T >( order , g\_stop );}
\DoxyCodeLine{602     \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = zp.plp;}
\DoxyCodeLine{603     \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = zp.glp;}
\DoxyCodeLine{604     \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = zp.zlp;}
\DoxyCodeLine{605     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = zp.L , R = zp.R , N = L + R;}
\DoxyCodeLine{606 }
\DoxyCodeLine{607     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{608 }
\DoxyCodeLine{609     \textcolor{comment}{// bandpass digital prototype poles, zeros and gains:}}
\DoxyCodeLine{610     \mbox{\hyperlink{classcomplex}{complex< T >}} *pbp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{611     \mbox{\hyperlink{classcomplex}{complex< T >}} *zbp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{612     \mbox{\hyperlink{classcomplex}{complex< T >}} *gbp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{613 }
\DoxyCodeLine{614     \textcolor{comment}{// coefficients matrix computation:}}
\DoxyCodeLine{615     T *cfnum = ( T* )calloc( 3 * (2*L+R) , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{616     T *cfden = ( T* )calloc( 3 * (2*L+R) , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{617     T *gains = ( T* )calloc( (2*L+R + 1) , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{618 }
\DoxyCodeLine{619     \textcolor{keywordflow}{if}( pbp   == 0 || zbp   == 0 || gbp   == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{620     \textcolor{keywordflow}{if}( cfnum == 0 || cfden == 0 || gains == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{621 }
\DoxyCodeLine{622     \textcolor{comment}{// LP-\/BP BILLINEAR TRANSFORM:}}
\DoxyCodeLine{623 }
\DoxyCodeLine{624     \textcolor{comment}{// poles transformation:}}
\DoxyCodeLine{625     T w0 = w1 * w2;}
\DoxyCodeLine{626     T dW = w2 -\/ w1;}
\DoxyCodeLine{627 }
\DoxyCodeLine{628     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{629     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} j = 0;}
\DoxyCodeLine{630     \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < L ; i++ , j+=2 )}
\DoxyCodeLine{631     \{}
\DoxyCodeLine{632         \textcolor{comment}{// poles transformation by means of square equation solve:}}
\DoxyCodeLine{633         \mbox{\hyperlink{classcomplex}{complex< T >}} a( 1 / w0 , 0 );}
\DoxyCodeLine{634         \mbox{\hyperlink{classcomplex}{complex< T >}} b( -\/plp[i].m\_re * dW / w0 , -\/plp[i].m\_im * dW / w0 );}
\DoxyCodeLine{635         \mbox{\hyperlink{classcomplex}{complex< T >}} c( 1 , 0 );}
\DoxyCodeLine{636         \mbox{\hyperlink{classcomplex}{complex< T >}} D = b * b -\/ a * c * 4;}
\DoxyCodeLine{637         \mbox{\hyperlink{classcomplex}{complex< T >}} p1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{638         \mbox{\hyperlink{classcomplex}{complex< T >}} p2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{639 }
\DoxyCodeLine{640         \textcolor{comment}{// zeros and poles bilinear transform:}}
\DoxyCodeLine{641         zbp[ j + 0 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( +1 , 0 );}
\DoxyCodeLine{642         zbp[ j + 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{643         pbp[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p1 );}
\DoxyCodeLine{644         pbp[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p2 );}
\DoxyCodeLine{645 }
\DoxyCodeLine{646         \textcolor{comment}{// digital filter coefficients computation:}}
\DoxyCodeLine{647 }
\DoxyCodeLine{648         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{649         cfnum[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{650         cfnum[ 3 * ( j + 0 ) + 1 ] = 0;}
\DoxyCodeLine{651         cfnum[ 3 * ( j + 0 ) + 2 ] = -\/1;}
\DoxyCodeLine{652         cfnum[ 3 * ( j + 1 ) + 0 ] = 1;}
\DoxyCodeLine{653         cfnum[ 3 * ( j + 1 ) + 1 ] = 0;}
\DoxyCodeLine{654         cfnum[ 3 * ( j + 1 ) + 2 ] = -\/1;}
\DoxyCodeLine{655 }
\DoxyCodeLine{656         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{657         cfden[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{658         cfden[ 3 * ( j + 0 ) + 1 ] = -\/( pbp[j] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbp[j] ) ).m\_re;}
\DoxyCodeLine{659         cfden[ 3 * ( j + 0 ) + 2 ] = +( pbp[j] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbp[j] ) ).m\_re;}
\DoxyCodeLine{660         cfden[ 3 * ( j + 1 ) + 0 ] = 1;}
\DoxyCodeLine{661         cfden[ 3 * ( j + 1 ) + 1 ] = -\/( pbp[j+1] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbp[j+1] ) ).m\_re;}
\DoxyCodeLine{662         cfden[ 3 * ( j + 1 ) + 2 ] = +( pbp[j+1] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbp[j+1] ) ).m\_re;}
\DoxyCodeLine{663 }
\DoxyCodeLine{664         \textcolor{comment}{// complex conjugate quadratic sections gains computation:}}
\DoxyCodeLine{665         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[i];}
\DoxyCodeLine{666         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = p1 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( p1 );}
\DoxyCodeLine{667         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = p2 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( p2 );}
\DoxyCodeLine{668         \mbox{\hyperlink{classcomplex}{complex< T >}} gain3 = (\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(p1));}
\DoxyCodeLine{669         \mbox{\hyperlink{classcomplex}{complex< T >}} gain4 = (\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p2)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(p2));}
\DoxyCodeLine{670         \mbox{\hyperlink{classcomplex}{complex< T >}} gain5 = gain0 * gain1 * gain2 / gain3 / gain4 * dW * dW / w0 / w0;}
\DoxyCodeLine{671         gain5 = \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( gain5 );}
\DoxyCodeLine{672         gains[j+0] = gain5.m\_re;}
\DoxyCodeLine{673         gains[j+1] = gain5.m\_re;}
\DoxyCodeLine{674     \}}
\DoxyCodeLine{675 }
\DoxyCodeLine{676     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{677     \textcolor{keywordflow}{if}( R == 1 )}
\DoxyCodeLine{678     \{}
\DoxyCodeLine{679         \textcolor{comment}{// pole transformation by means of square equation solve:}}
\DoxyCodeLine{680         \mbox{\hyperlink{classcomplex}{complex< T >}} a( 1 / w0 , 0 );}
\DoxyCodeLine{681         \mbox{\hyperlink{classcomplex}{complex< T >}} b( -\/plp[ N -\/ 1 ].m\_re * dW / w0 , -\/plp[ N -\/ 1 ].m\_im * dW / w0 );}
\DoxyCodeLine{682         \mbox{\hyperlink{classcomplex}{complex< T >}} c( 1 , 0 );}
\DoxyCodeLine{683         \mbox{\hyperlink{classcomplex}{complex< T >}} D = b * b -\/ a * c * 4;}
\DoxyCodeLine{684         \mbox{\hyperlink{classcomplex}{complex< T >}} p1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{685         \mbox{\hyperlink{classcomplex}{complex< T >}} p2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{686 }
\DoxyCodeLine{687         \textcolor{comment}{// zeros and poles bilinear transform:}}
\DoxyCodeLine{688         zbp[ j + 0 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( +1 , 0 );}
\DoxyCodeLine{689         zbp[ j + 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{690         pbp[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p1 );}
\DoxyCodeLine{691         pbp[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p2 );}
\DoxyCodeLine{692 }
\DoxyCodeLine{693         \textcolor{comment}{// digital filter coefficients computation:}}
\DoxyCodeLine{694 }
\DoxyCodeLine{695         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{696         cfnum[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{697         cfnum[ 3 * ( j + 0 ) + 1 ] = 0;}
\DoxyCodeLine{698         cfnum[ 3 * ( j + 0 ) + 2 ] = -\/1;}
\DoxyCodeLine{699 }
\DoxyCodeLine{700         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{701         cfden[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{702         cfden[ 3 * ( j + 0 ) + 1 ] = -\/( pbp[j] + pbp[j+1] ).m\_re;}
\DoxyCodeLine{703         cfden[ 3 * ( j + 0 ) + 2 ] = +( pbp[j] * pbp[j+1] ).m\_re;}
\DoxyCodeLine{704 }
\DoxyCodeLine{705         \textcolor{comment}{// complex conjugate quadratic sections gains computation:}}
\DoxyCodeLine{706         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[N-\/1];}
\DoxyCodeLine{707         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = p1 * p2;}
\DoxyCodeLine{708         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = (\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p2);}
\DoxyCodeLine{709         \mbox{\hyperlink{classcomplex}{complex< T >}} gain3 = gain0 * gain1 / gain2 * dW / w0;}
\DoxyCodeLine{710         gains[j+0] = gain3.m\_re;}
\DoxyCodeLine{711     \}}
\DoxyCodeLine{712 }
\DoxyCodeLine{713     \textcolor{comment}{// setting filter output gain:}}
\DoxyCodeLine{714     gains[ 2*L+R ] = glp[N].m\_re;}
\DoxyCodeLine{715 }
\DoxyCodeLine{716     \textcolor{comment}{// memory free:}}
\DoxyCodeLine{717     free( plp );}
\DoxyCodeLine{718     free( zlp );}
\DoxyCodeLine{719     free( glp );}
\DoxyCodeLine{720     free( pbp );}
\DoxyCodeLine{721     free( zbp );}
\DoxyCodeLine{722     free( gbp );}
\DoxyCodeLine{723 }
\DoxyCodeLine{724     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf<  T  >}}\{ cfnum , cfden , gains , 2*L , R , 2*L+R  \};}
\DoxyCodeLine{725 \}}
\DoxyCodeLine{726 }
\DoxyCodeLine{727 \textcolor{comment}{//  Butterworth or Chebyshev type I digital bandstop computation:}}
\DoxyCodeLine{728 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}} \_\_butt\_cheb1\_digital\_bs\_\_( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BandWidth , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_abc3e3e3fbdd4de8d12c8a8e4057be945}{\_\_fx32}} type = 0 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop = 1 )}
\DoxyCodeLine{729 \{}
\DoxyCodeLine{730     \textcolor{comment}{// Fs           -\/ sampling frequency}}
\DoxyCodeLine{731     \textcolor{comment}{// Fstop        -\/ stopband frequency}}
\DoxyCodeLine{732     \textcolor{comment}{// BandWidth    -\/ passband withd}}
\DoxyCodeLine{733     \textcolor{comment}{// order        -\/ filter order}}
\DoxyCodeLine{734     \textcolor{comment}{// coeffs\_num   -\/ quadratic sections numerator coefficients}}
\DoxyCodeLine{735     \textcolor{comment}{// coeffs\_den   -\/ quadratic sections denominator coefficients}}
\DoxyCodeLine{736     \textcolor{comment}{// gains        -\/ quadratic sections gains}}
\DoxyCodeLine{737     \textcolor{comment}{// type         -\/ filter type ( 0 -\/ Butterworth , 1 -\/ Chebyshev )}}
\DoxyCodeLine{738     \textcolor{comment}{// g\_stop       -\/ stopband attenuation in Db}}
\DoxyCodeLine{739 }
\DoxyCodeLine{740     \textcolor{comment}{// INITIALIZATION:}}
\DoxyCodeLine{741 }
\DoxyCodeLine{742     order /= 2;}
\DoxyCodeLine{743 }
\DoxyCodeLine{744    \textcolor{comment}{// frequency deformation coefficient:}}
\DoxyCodeLine{745    T w1 = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * Fc / 2 / Fs ) , w2 = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * ( Fc + BandWidth ) / 2 / Fs );}
\DoxyCodeLine{746 }
\DoxyCodeLine{747    \textcolor{comment}{// allocate zeros and poles arrays:}}
\DoxyCodeLine{748 }
\DoxyCodeLine{749    \textcolor{comment}{// lowpass analogue prototype poles, zeros and gains:}}
\DoxyCodeLine{750    \mbox{\hyperlink{structiir__zp}{iir\_zp < T >}} zp = ( !type ) ? \_\_butt\_zeros\_poles\_plain\_\_< T >( order , g\_stop ) : \_\_cheb1\_zeros\_poles\_plain\_\_< T >( order , g\_stop );}
\DoxyCodeLine{751    \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = zp.plp;}
\DoxyCodeLine{752    \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = zp.glp;}
\DoxyCodeLine{753    \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = zp.zlp;}
\DoxyCodeLine{754    \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = zp.L , R = zp.R , N = L + R;}
\DoxyCodeLine{755 }
\DoxyCodeLine{756    \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{757 }
\DoxyCodeLine{758     \textcolor{comment}{// bandpass digital prototype poles, zeros and gains:}}
\DoxyCodeLine{759     \mbox{\hyperlink{classcomplex}{complex< T >}} *pbs = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{760     \mbox{\hyperlink{classcomplex}{complex< T >}} *zbs = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{761     \mbox{\hyperlink{classcomplex}{complex< T >}} *gbs = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{762 }
\DoxyCodeLine{763     \textcolor{comment}{// coefficients matrix computation:}}
\DoxyCodeLine{764     T *cfnum = (T* )calloc( 3 * (2*L+R) , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{765     T *cfden = (T* )calloc( 3 * (2*L+R) , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{766     T *gains = (T* )calloc( (2*L+R+1)   , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{767 }
\DoxyCodeLine{768     \textcolor{keywordflow}{if}( pbs   == 0 || pbs   == 0 || pbs   == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{769     \textcolor{keywordflow}{if}( cfnum == 0 || cfden == 0 || gains == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{770 }
\DoxyCodeLine{771     \textcolor{comment}{// LP-\/BS BILLINEAR TRANSFORM:}}
\DoxyCodeLine{772 }
\DoxyCodeLine{773     \textcolor{comment}{// poles transformation:}}
\DoxyCodeLine{774     T w0 = w1 * w2;}
\DoxyCodeLine{775     T dW = w2 -\/ w1;}
\DoxyCodeLine{776 }
\DoxyCodeLine{777     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{778     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} j = 0;}
\DoxyCodeLine{779     \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < L ; i++ , j+=2 )}
\DoxyCodeLine{780     \{}
\DoxyCodeLine{781         \textcolor{comment}{// poles transformation by means of square equation solve:}}
\DoxyCodeLine{782         \mbox{\hyperlink{classcomplex}{complex< T >}} a = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 / w0 , 0 );}
\DoxyCodeLine{783         \mbox{\hyperlink{classcomplex}{complex< T >}} b = \mbox{\hyperlink{classcomplex}{complex< T >}}( dW , 0 ) / plp[i] / w0;}
\DoxyCodeLine{784         \mbox{\hyperlink{classcomplex}{complex< T >}} c = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{785         \mbox{\hyperlink{classcomplex}{complex< T >}} D = b * b -\/ a * c * 4;}
\DoxyCodeLine{786         \mbox{\hyperlink{classcomplex}{complex< T >}} p1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{787         \mbox{\hyperlink{classcomplex}{complex< T >}} p2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{788 }
\DoxyCodeLine{789         \textcolor{comment}{// zeros and poles bilinear transform:}}
\DoxyCodeLine{790         zbs[ j + 0 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( +1 , 0 );}
\DoxyCodeLine{791         zbs[ j + 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{792         pbs[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p1 );}
\DoxyCodeLine{793         pbs[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p2 );}
\DoxyCodeLine{794 }
\DoxyCodeLine{795         \textcolor{comment}{// digital filter coefficients computation:}}
\DoxyCodeLine{796 }
\DoxyCodeLine{797         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{798         cfnum[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{799         cfnum[ 3 * ( j + 0 ) + 1 ] = 2 * ( w0 -\/ 1 ) / ( w0 + 1 );}
\DoxyCodeLine{800         cfnum[ 3 * ( j + 0 ) + 2 ] = 1;}
\DoxyCodeLine{801         cfnum[ 3 * ( j + 1 ) + 0 ] = 1;}
\DoxyCodeLine{802         cfnum[ 3 * ( j + 1 ) + 1 ] = 2 * ( w0 -\/ 1 ) / ( w0 + 1 );}
\DoxyCodeLine{803         cfnum[ 3 * ( j + 1 ) + 2 ] = 1;}
\DoxyCodeLine{804 }
\DoxyCodeLine{805         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{806         cfden[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{807         cfden[ 3 * ( j + 0 ) + 1 ] = -\/( pbs[j] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbs[j] ) ).m\_re;}
\DoxyCodeLine{808         cfden[ 3 * ( j + 0 ) + 2 ] = +( pbs[j] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbs[j] ) ).m\_re;}
\DoxyCodeLine{809         cfden[ 3 * ( j + 1 ) + 0 ] = 1;}
\DoxyCodeLine{810         cfden[ 3 * ( j + 1 ) + 1 ] = -\/( pbs[j+1] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbs[j+1] ) ).m\_re;}
\DoxyCodeLine{811         cfden[ 3 * ( j + 1 ) + 2 ] = +( pbs[j+1] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbs[j+1] ) ).m\_re;}
\DoxyCodeLine{812 }
\DoxyCodeLine{813         \textcolor{comment}{// complex conjugate quadratic sections gains computation:}}
\DoxyCodeLine{814         \textcolor{comment}{//complex<\_\_fx64> gain0 = glp[i];}}
\DoxyCodeLine{815         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0);}
\DoxyCodeLine{816         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = p1 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( p1 );}
\DoxyCodeLine{817         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = p2 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( p2 );}
\DoxyCodeLine{818         \mbox{\hyperlink{classcomplex}{complex< T >}} gain3 = (\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(p1));}
\DoxyCodeLine{819         \mbox{\hyperlink{classcomplex}{complex< T >}} gain4 = (\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p2)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(p2));}
\DoxyCodeLine{820         \mbox{\hyperlink{classcomplex}{complex< T >}} gain5 = gain0 * gain1 * gain2 / gain3 / gain4 / w0 / w0 * ( 1 + w0 ) * ( 1 + w0 );}
\DoxyCodeLine{821         gain5 = \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( gain5 );}
\DoxyCodeLine{822         gains[j+0] = gain5.m\_re;}
\DoxyCodeLine{823         gains[j+1] = gains[j+0];}
\DoxyCodeLine{824     \}}
\DoxyCodeLine{825 }
\DoxyCodeLine{826     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{827     \textcolor{keywordflow}{if}( R == 1 )}
\DoxyCodeLine{828     \{}
\DoxyCodeLine{829         \textcolor{comment}{// poles transformation by means of square equation solve:}}
\DoxyCodeLine{830         \mbox{\hyperlink{classcomplex}{complex< T >}} a = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 / w0 , 0 );}
\DoxyCodeLine{831         \mbox{\hyperlink{classcomplex}{complex< T >}} b = \mbox{\hyperlink{classcomplex}{complex< T >}}( dW , 0 ) / plp[N-\/1] / w0;}
\DoxyCodeLine{832         \mbox{\hyperlink{classcomplex}{complex< T >}} c = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{833         \mbox{\hyperlink{classcomplex}{complex< T >}} D = b * b -\/ a * c * 4;}
\DoxyCodeLine{834         \mbox{\hyperlink{classcomplex}{complex< T >}} p1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{835         \mbox{\hyperlink{classcomplex}{complex< T >}} p2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{836 }
\DoxyCodeLine{837         \textcolor{comment}{// zeros and poles bilinear transform:}}
\DoxyCodeLine{838         zbs[ j + 0 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( +1 , 0 );}
\DoxyCodeLine{839         zbs[ j + 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{840         pbs[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p1 );}
\DoxyCodeLine{841         pbs[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p2 );}
\DoxyCodeLine{842 }
\DoxyCodeLine{843         \textcolor{comment}{// digital filter coefficients computation:}}
\DoxyCodeLine{844 }
\DoxyCodeLine{845         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{846         cfnum[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{847         cfnum[ 3 * ( j + 0 ) + 1 ] = 2 * ( w0 -\/ 1 ) / ( w0 + 1 );}
\DoxyCodeLine{848         cfnum[ 3 * ( j + 0 ) + 2 ] = 1;}
\DoxyCodeLine{849 }
\DoxyCodeLine{850         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{851         cfden[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{852         cfden[ 3 * ( j + 0 ) + 1 ] = -\/( pbs[j]+pbs[j+1] ).m\_re;}
\DoxyCodeLine{853         cfden[ 3 * ( j + 0 ) + 2 ] = +( pbs[j]*pbs[j+1] ).m\_re;}
\DoxyCodeLine{854 }
\DoxyCodeLine{855         \textcolor{comment}{// complex conjugate quadratic sections gains computation:}}
\DoxyCodeLine{856         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[N-\/1];}
\DoxyCodeLine{857         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = p1 * p2;}
\DoxyCodeLine{858         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) / plp[N-\/1] / (-\/1);}
\DoxyCodeLine{859         \mbox{\hyperlink{classcomplex}{complex< T >}} gain3 = (\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p2);}
\DoxyCodeLine{860         \mbox{\hyperlink{classcomplex}{complex< T >}} gain4 = gain0 * gain1 * gain2 / gain3 / w0 * ( 1 + w0 );}
\DoxyCodeLine{861         gains[j+0] = gain4.m\_re;}
\DoxyCodeLine{862     \}}
\DoxyCodeLine{863 }
\DoxyCodeLine{864     \textcolor{comment}{// setting filter output gain:}}
\DoxyCodeLine{865     gains[ 2 * L + R ] = glp[ N ].m\_re;}
\DoxyCodeLine{866 }
\DoxyCodeLine{867     \textcolor{comment}{// memory free:}}
\DoxyCodeLine{868     free( plp );}
\DoxyCodeLine{869     free( zlp );}
\DoxyCodeLine{870     free( glp );}
\DoxyCodeLine{871     free( pbs );}
\DoxyCodeLine{872     free( zbs );}
\DoxyCodeLine{873     free( gbs );}
\DoxyCodeLine{874 }
\DoxyCodeLine{875     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ cfnum , cfden , gains , 2 * L , R , 2 * L + R \};}
\DoxyCodeLine{876 \}}
\DoxyCodeLine{877 }
\DoxyCodeLine{878 \textcolor{comment}{// NON-\/UNIT NUMERATOR IIR COEFFICIENTS COMPUTATION:}}
\DoxyCodeLine{879 }
\DoxyCodeLine{880 \textcolor{comment}{// Elliptic or Chebyshev type II digital lowpass computation function:}}
\DoxyCodeLine{881 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}} \_\_cheb2\_ellip\_digital\_lp\_\_( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} type = 0 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_pass = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop = 80 )}
\DoxyCodeLine{882 \{}
\DoxyCodeLine{883     \textcolor{comment}{// Fs           -\/ sampling frequency}}
\DoxyCodeLine{884     \textcolor{comment}{// Fstop        -\/ cutoff frequency}}
\DoxyCodeLine{885     \textcolor{comment}{// order        -\/ filter order}}
\DoxyCodeLine{886     \textcolor{comment}{// coeffs\_num   -\/ quadratic sections numerator coefficients}}
\DoxyCodeLine{887     \textcolor{comment}{// coeffs\_den   -\/ quadratic sections denominator coefficients}}
\DoxyCodeLine{888     \textcolor{comment}{// gains        -\/ quadratic sections gains}}
\DoxyCodeLine{889     \textcolor{comment}{// type         -\/ filter type ( 0 -\/ Chebyshev type II , 1 -\/ Elliptic )}}
\DoxyCodeLine{890     \textcolor{comment}{// g\_stop       -\/ stopband attenuation in Db}}
\DoxyCodeLine{891 }
\DoxyCodeLine{892     T w = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * Fc / 2 / Fs );}
\DoxyCodeLine{893 }
\DoxyCodeLine{894     \textcolor{comment}{// digital lowpass coefficients computation:}}
\DoxyCodeLine{895     \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} zp = ( !type ) ? \_\_cheb2\_zeros\_poles\_plain\_\_< T >( order , g\_stop ) : \_\_ellip\_zeros\_poles\_plain\_\_< T >( order , g\_pass , g\_stop );}
\DoxyCodeLine{896 }
\DoxyCodeLine{897     \textcolor{comment}{// zeros/poles and coefficients number:}}
\DoxyCodeLine{898     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = zp.L;}
\DoxyCodeLine{899     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} R = zp.R;}
\DoxyCodeLine{900     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} N = zp.N;}
\DoxyCodeLine{901 }
\DoxyCodeLine{902     \textcolor{comment}{// zeros / poles plain initialization:}}
\DoxyCodeLine{903     \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = zp.plp;}
\DoxyCodeLine{904     \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = zp.zlp;}
\DoxyCodeLine{905     \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = zp.glp;}
\DoxyCodeLine{906 }
\DoxyCodeLine{907     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{908 }
\DoxyCodeLine{909     \textcolor{comment}{// coefficients matrix computation:}}
\DoxyCodeLine{910      T  *cfnum = ( T * )calloc( 3 * N , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{911      T  *cfden = ( T * )calloc( 3 * N , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{912      T  *gains = ( T * )calloc( N + 1 , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{913 }
\DoxyCodeLine{914     \textcolor{keywordflow}{if}( cfnum == 0 || cfden == 0 || gains == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{915 }
\DoxyCodeLine{916     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{917     \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < L ; i++)}
\DoxyCodeLine{918     \{}
\DoxyCodeLine{919         \textcolor{comment}{// quadratic sections gains computation:}}
\DoxyCodeLine{920         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[i];}
\DoxyCodeLine{921         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ zlp[i] * w ) * ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zlp[i] ) * w );}
\DoxyCodeLine{922         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[i] * w ) * ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) * w );}
\DoxyCodeLine{923         gains[ i ] = ( gain0 * gain1 / gain2 ).m\_re;}
\DoxyCodeLine{924 }
\DoxyCodeLine{925         \textcolor{comment}{// zeros and poles transformation:}}
\DoxyCodeLine{926         zlp[i] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + zlp[i] * w ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ zlp[i] * w );}
\DoxyCodeLine{927         plp[i] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + plp[i] * w ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[i] * w );}
\DoxyCodeLine{928 }
\DoxyCodeLine{929         \textcolor{comment}{// quadratic sections coefficients computation:}}
\DoxyCodeLine{930 }
\DoxyCodeLine{931         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{932         cfnum[ 3 * i + 0 ] = 1;}
\DoxyCodeLine{933         cfnum[ 3 * i + 1 ] = -\/( zlp[i] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zlp[i] ) ).m\_re;}
\DoxyCodeLine{934         cfnum[ 3 * i + 2 ] = +( zlp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zlp[i] ) ).m\_re;}
\DoxyCodeLine{935 }
\DoxyCodeLine{936         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{937         cfden[ 3 * i + 0 ] = 1;}
\DoxyCodeLine{938         cfden[ 3 * i + 1 ] = -\/( plp[i] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) ).m\_re;}
\DoxyCodeLine{939         cfden[ 3 * i + 2 ] = +( plp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) ).m\_re;}
\DoxyCodeLine{940     \}}
\DoxyCodeLine{941 }
\DoxyCodeLine{942     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{943     \textcolor{keywordflow}{if}( R >= 1 )}
\DoxyCodeLine{944     \{}
\DoxyCodeLine{945         \textcolor{comment}{// quadratic sections gains computation:}}
\DoxyCodeLine{946         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[ N -\/ 1 ];}
\DoxyCodeLine{947         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = \mbox{\hyperlink{classcomplex}{complex< T >}}( w , 0 );}
\DoxyCodeLine{948         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[ N -\/ 1 ] * w );}
\DoxyCodeLine{949         gains[ N -\/ 1 ] = ( gain0 * gain1 / gain2 ).m\_re;}
\DoxyCodeLine{950 }
\DoxyCodeLine{951         \textcolor{comment}{// zeros and poles transformation:}}
\DoxyCodeLine{952         zlp[ N -\/ 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{953         plp[ N -\/ 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + plp[ N -\/ 1 ] * w ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[ N -\/ 1 ] * w );}
\DoxyCodeLine{954 }
\DoxyCodeLine{955         \textcolor{comment}{// quadratic sections coefficients computation:}}
\DoxyCodeLine{956 }
\DoxyCodeLine{957         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{958         cfnum[ 3 * (N -\/ 1) + 0 ] = 1;}
\DoxyCodeLine{959         cfnum[ 3 * (N -\/ 1) + 1 ] = -\/zlp[ N -\/ 1 ].m\_re;}
\DoxyCodeLine{960         cfnum[ 3 * (N -\/ 1) + 2 ] = 0;}
\DoxyCodeLine{961 }
\DoxyCodeLine{962         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{963         cfden[ 3 * (N -\/ 1) + 0 ] = 1;}
\DoxyCodeLine{964         cfden[ 3 * (N -\/ 1) + 1 ] = -\/plp[ N -\/ 1 ].m\_re;}
\DoxyCodeLine{965         cfden[ 3 * (N -\/ 1) + 2 ] = 0;}
\DoxyCodeLine{966 }
\DoxyCodeLine{967     \}}
\DoxyCodeLine{968 }
\DoxyCodeLine{969     gains[N] = glp[N].m\_re;}
\DoxyCodeLine{970 }
\DoxyCodeLine{971     \textcolor{comment}{// memory deallocation:}}
\DoxyCodeLine{972     free( plp );}
\DoxyCodeLine{973     free( zlp );}
\DoxyCodeLine{974     free( glp );}
\DoxyCodeLine{975 }
\DoxyCodeLine{976     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ cfnum , cfden , gains , L , R , N \};}
\DoxyCodeLine{977 \}}
\DoxyCodeLine{978 }
\DoxyCodeLine{979 \textcolor{comment}{// Elliptic or Chebyshev type II digital highpass computation function:}}
\DoxyCodeLine{980 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}} \_\_cheb2\_ellip\_digital\_hp\_\_( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} type = 0 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_pass = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop = 80 )}
\DoxyCodeLine{981 \{}
\DoxyCodeLine{982     \textcolor{comment}{// Fs           -\/ sampling frequency}}
\DoxyCodeLine{983     \textcolor{comment}{// Fstop        -\/ cutoff frequency}}
\DoxyCodeLine{984     \textcolor{comment}{// order        -\/ filter order}}
\DoxyCodeLine{985     \textcolor{comment}{// coeffs\_num   -\/ quadratic sections numerator coefficients}}
\DoxyCodeLine{986     \textcolor{comment}{// coeffs\_den   -\/ quadratic sections denominator coefficients}}
\DoxyCodeLine{987     \textcolor{comment}{// gains        -\/ quadratic sections gains}}
\DoxyCodeLine{988     \textcolor{comment}{// type         -\/ filter type ( 0 -\/ Chebyshev II , 1 -\/ Elliptic )}}
\DoxyCodeLine{989     \textcolor{comment}{// g\_stop       -\/ stopband attenuation in Db}}
\DoxyCodeLine{990 }
\DoxyCodeLine{991      T  w = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * Fc / 2 / Fs );}
\DoxyCodeLine{992 }
\DoxyCodeLine{993     \textcolor{comment}{// digital lowpass coefficients computation:}}
\DoxyCodeLine{994     \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} zp = ( !type ) ? \_\_cheb2\_zeros\_poles\_plain\_\_< T >( order , g\_stop ) : \_\_ellip\_zeros\_poles\_plain\_\_< T >( order , g\_pass , g\_stop );}
\DoxyCodeLine{995 }
\DoxyCodeLine{996     \textcolor{comment}{// zeros/poles and coefficients number:}}
\DoxyCodeLine{997     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = zp.L;}
\DoxyCodeLine{998     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} R = zp.R;}
\DoxyCodeLine{999     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} N = zp.N;}
\DoxyCodeLine{1000 }
\DoxyCodeLine{1001     \textcolor{comment}{// zeros / poles plain initialization:}}
\DoxyCodeLine{1002     \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = zp.plp;}
\DoxyCodeLine{1003     \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = zp.zlp;}
\DoxyCodeLine{1004     \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = zp.glp;}
\DoxyCodeLine{1005 }
\DoxyCodeLine{1006     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{1007 }
\DoxyCodeLine{1008     \textcolor{comment}{// coefficients matrix memory allocation:}}
\DoxyCodeLine{1009      T *cfnum = (T* )calloc( 3 * N , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{1010      T *cfden = (T* )calloc( 3 * N , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{1011      T *gains = (T* )calloc( N + 1 , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{1012 }
\DoxyCodeLine{1013     \textcolor{keywordflow}{if}( cfnum == 0 || cfden == 0 || gains == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{1014 }
\DoxyCodeLine{1015     \textcolor{comment}{// coefficients matrix computation:}}
\DoxyCodeLine{1016 }
\DoxyCodeLine{1017     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{1018     \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < L ; i++)}
\DoxyCodeLine{1019     \{}
\DoxyCodeLine{1020         \textcolor{comment}{// quadratic sections gains computation:}}
\DoxyCodeLine{1021         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[i];}
\DoxyCodeLine{1022         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ zlp[i] / w ) * ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zlp[i] ) / w );}
\DoxyCodeLine{1023         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[i] / w ) * ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) / w );}
\DoxyCodeLine{1024         gains[ i ] = ( gain0 * gain1 / gain2 ).m\_re;}
\DoxyCodeLine{1025 }
\DoxyCodeLine{1026         \textcolor{comment}{// zeros and poles transformation:}}
\DoxyCodeLine{1027         zlp[i] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + zlp[i] / w ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ zlp[i] / w );}
\DoxyCodeLine{1028         plp[i] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + plp[i] / w ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[i] / w );}
\DoxyCodeLine{1029 }
\DoxyCodeLine{1030         \textcolor{comment}{// quadratic sections coefficients computation:}}
\DoxyCodeLine{1031 }
\DoxyCodeLine{1032         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{1033         cfnum[ 3 * i + 0 ] = 1;}
\DoxyCodeLine{1034         cfnum[ 3 * i + 1 ] = +( zlp[i] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zlp[i] ) ).m\_re;}
\DoxyCodeLine{1035         cfnum[ 3 * i + 2 ] = +( zlp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zlp[i] ) ).m\_re;}
\DoxyCodeLine{1036 }
\DoxyCodeLine{1037         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{1038         cfden[ 3 * i + 0 ] = 1;}
\DoxyCodeLine{1039         cfden[ 3 * i + 1 ] = +( plp[i] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) ).m\_re;}
\DoxyCodeLine{1040         cfden[ 3 * i + 2 ] = +( plp[i] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( plp[i] ) ).m\_re;}
\DoxyCodeLine{1041     \}}
\DoxyCodeLine{1042 }
\DoxyCodeLine{1043     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{1044     \textcolor{keywordflow}{if}( R >= 1 )}
\DoxyCodeLine{1045     \{}
\DoxyCodeLine{1046         \textcolor{comment}{// quadratic sections gains computation:}}
\DoxyCodeLine{1047         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[ N -\/ 1 ];}
\DoxyCodeLine{1048         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 / w , 0 );}
\DoxyCodeLine{1049         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[ N -\/ 1 ] / w );}
\DoxyCodeLine{1050         gains[ N -\/ 1 ] = ( gain0 * gain1 / gain2 ).m\_re;}
\DoxyCodeLine{1051 }
\DoxyCodeLine{1052         \textcolor{comment}{// zeros and poles transformation:}}
\DoxyCodeLine{1053         zlp[ N -\/ 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{1054         plp[ N -\/ 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + plp[ N -\/ 1 ] / w ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ plp[ N -\/ 1 ] / w );}
\DoxyCodeLine{1055 }
\DoxyCodeLine{1056         \textcolor{comment}{// quadratic sections coefficients computation:}}
\DoxyCodeLine{1057 }
\DoxyCodeLine{1058         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{1059         cfnum[ 3 * (N -\/ 1) + 0 ] = 1;}
\DoxyCodeLine{1060         cfnum[ 3 * (N -\/ 1) + 1 ] = zlp[ N -\/ 1 ].m\_re;}
\DoxyCodeLine{1061         cfnum[ 3 * (N -\/ 1) + 2 ] = 0;}
\DoxyCodeLine{1062 }
\DoxyCodeLine{1063         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{1064         cfden[ 3 * (N -\/ 1) + 0 ] = 1;}
\DoxyCodeLine{1065         cfden[ 3 * (N -\/ 1) + 1 ] = plp[ N -\/ 1 ].m\_re;}
\DoxyCodeLine{1066         cfden[ 3 * (N -\/ 1) + 2 ] = 0;}
\DoxyCodeLine{1067     \}}
\DoxyCodeLine{1068 }
\DoxyCodeLine{1069     \textcolor{comment}{// output gain setting:}}
\DoxyCodeLine{1070     gains[N] = glp[N].m\_re;}
\DoxyCodeLine{1071 }
\DoxyCodeLine{1072     \textcolor{comment}{// memory deallocation:}}
\DoxyCodeLine{1073     free( plp );}
\DoxyCodeLine{1074     free( zlp );}
\DoxyCodeLine{1075     free( glp );}
\DoxyCodeLine{1076 }
\DoxyCodeLine{1077     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ cfnum , cfden , gains , L , R , N \};}
\DoxyCodeLine{1078 \}}
\DoxyCodeLine{1079 }
\DoxyCodeLine{1080 \textcolor{comment}{// Elliptic or Chebyshev II digital bandpass computation function:}}
\DoxyCodeLine{1081 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}} \_\_cheb2\_ellip\_digital\_bp\_\_( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fp , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BandWidth , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} type = 0 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_pass = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop = 80 )}
\DoxyCodeLine{1082 \{}
\DoxyCodeLine{1083     \textcolor{comment}{// Fs           -\/ sampling frequency}}
\DoxyCodeLine{1084     \textcolor{comment}{// Fpass        -\/ passband frequency}}
\DoxyCodeLine{1085     \textcolor{comment}{// BandWidth    -\/ passband withd}}
\DoxyCodeLine{1086     \textcolor{comment}{// order        -\/ filter order}}
\DoxyCodeLine{1087     \textcolor{comment}{// coeffs\_num   -\/ quadratic sections numerator coefficients}}
\DoxyCodeLine{1088     \textcolor{comment}{// coeffs\_den   -\/ quadratic sections denominator coefficients}}
\DoxyCodeLine{1089     \textcolor{comment}{// gains        -\/ quadratic sections gains}}
\DoxyCodeLine{1090     \textcolor{comment}{// type         -\/ filter type ( 0 -\/ Butterworth , 1 -\/ Chebyshev )}}
\DoxyCodeLine{1091     \textcolor{comment}{// g\_stop       -\/ stopband attenuation in Db}}
\DoxyCodeLine{1092 }
\DoxyCodeLine{1093      order /= 2;}
\DoxyCodeLine{1094 }
\DoxyCodeLine{1095     \textcolor{comment}{// frequency deformation coefficient:}}
\DoxyCodeLine{1096      T w1 = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * Fp / 2 / Fs ) , w2 = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * ( Fp + BandWidth ) / 2 / Fs );}
\DoxyCodeLine{1097 }
\DoxyCodeLine{1098     \textcolor{comment}{// allocate zeros and poles arrays:}}
\DoxyCodeLine{1099 }
\DoxyCodeLine{1100     \textcolor{comment}{// lowpass analogue prototype poles, zeros and gains:}}
\DoxyCodeLine{1101     \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} zp = ( !type ) ? \_\_cheb2\_zeros\_poles\_plain\_\_< T >( order , g\_stop ) : \_\_ellip\_zeros\_poles\_plain\_\_< T >( order , g\_pass , g\_stop );}
\DoxyCodeLine{1102     \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = zp.plp;}
\DoxyCodeLine{1103     \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = zp.glp;}
\DoxyCodeLine{1104     \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = zp.zlp;}
\DoxyCodeLine{1105     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = zp.L , R = zp.R , N = L + R;}
\DoxyCodeLine{1106 }
\DoxyCodeLine{1107     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{1108 }
\DoxyCodeLine{1109     \textcolor{comment}{// bandpass digital prototype poles, zeros and gains:}}
\DoxyCodeLine{1110     \mbox{\hyperlink{classcomplex}{complex< T >}} *pbp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{1111     \mbox{\hyperlink{classcomplex}{complex< T >}} *zbp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{1112     \mbox{\hyperlink{classcomplex}{complex< T >}} *gbp = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{1113 }
\DoxyCodeLine{1114     \textcolor{comment}{// coefficients matrix computation:}}
\DoxyCodeLine{1115      T  *cfnum = ( T * )calloc( 3 * (2*L+R) , \textcolor{keyword}{sizeof} (  T  ) );}
\DoxyCodeLine{1116      T  *cfden = ( T * )calloc( 3 * (2*L+R) , \textcolor{keyword}{sizeof} (  T  ) );}
\DoxyCodeLine{1117      T  *gains = ( T * )calloc( (2*L+R + 1) , \textcolor{keyword}{sizeof} (  T  ) );}
\DoxyCodeLine{1118 }
\DoxyCodeLine{1119     \textcolor{keywordflow}{if}( pbp   == 0 || zbp   == 0 || gbp   == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{1120     \textcolor{keywordflow}{if}( cfnum == 0 || cfden == 0 || gains == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{1121 }
\DoxyCodeLine{1122     \textcolor{comment}{// LP-\/BP BILLINEAR TRANSFORM:}}
\DoxyCodeLine{1123 }
\DoxyCodeLine{1124     \textcolor{comment}{// poles transformation:}}
\DoxyCodeLine{1125      T w0 = w1 * w2;}
\DoxyCodeLine{1126      T dW = w2 -\/ w1;}
\DoxyCodeLine{1127 }
\DoxyCodeLine{1128     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{1129     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} j = 0;}
\DoxyCodeLine{1130 }
\DoxyCodeLine{1131     \textcolor{comment}{// auxiliary variables:}}
\DoxyCodeLine{1132     \mbox{\hyperlink{classcomplex}{complex< T >}} a , b , c , D , z1 , z2 , p1 , p2;}
\DoxyCodeLine{1133 }
\DoxyCodeLine{1134     \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < L ; i++ , j+=2 )}
\DoxyCodeLine{1135     \{}
\DoxyCodeLine{1136         \textcolor{comment}{// zeros frequency transformation by means of square equation solve:}}
\DoxyCodeLine{1137         a = 1 / w0;}
\DoxyCodeLine{1138         b = zlp[i] * dW / w0 * (-\/1);}
\DoxyCodeLine{1139         c = 1;}
\DoxyCodeLine{1140         D = b * b -\/ a * c * 4;}
\DoxyCodeLine{1141         z1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1142         z2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1143 }
\DoxyCodeLine{1144         \textcolor{comment}{// poles frequency transformation by means of square equation solve:}}
\DoxyCodeLine{1145         a = 1 / w0;}
\DoxyCodeLine{1146         b = plp[i] * dW / w0 * (-\/1);}
\DoxyCodeLine{1147         c = 1;}
\DoxyCodeLine{1148         D = b * b -\/ a * c * 4;}
\DoxyCodeLine{1149         p1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1150         p2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1151 }
\DoxyCodeLine{1152         \textcolor{comment}{// zeros and poles bilinear transform:}}
\DoxyCodeLine{1153         zbp[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + z1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ z1 );}
\DoxyCodeLine{1154         zbp[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + z2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ z2 );}
\DoxyCodeLine{1155         pbp[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p1 );}
\DoxyCodeLine{1156         pbp[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p2 );}
\DoxyCodeLine{1157 }
\DoxyCodeLine{1158         \textcolor{comment}{// filter coefficients computation:}}
\DoxyCodeLine{1159 }
\DoxyCodeLine{1160         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{1161         cfnum[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{1162         cfnum[ 3 * ( j + 0 ) + 1 ] = -\/( zbp[j] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zbp[j] ) ).m\_re;}
\DoxyCodeLine{1163         cfnum[ 3 * ( j + 0 ) + 2 ] = +( zbp[j] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zbp[j] ) ).m\_re;}
\DoxyCodeLine{1164         cfnum[ 3 * ( j + 1 ) + 0 ] = 1;}
\DoxyCodeLine{1165         cfnum[ 3 * ( j + 1 ) + 1 ] = -\/( zbp[j+1] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zbp[j+1] ) ).m\_re;}
\DoxyCodeLine{1166         cfnum[ 3 * ( j + 1 ) + 2 ] = +( zbp[j+1] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zbp[j+1] ) ).m\_re;}
\DoxyCodeLine{1167 }
\DoxyCodeLine{1168         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{1169         cfden[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{1170         cfden[ 3 * ( j + 0 ) + 1 ] = -\/( pbp[j] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbp[j] ) ).m\_re;}
\DoxyCodeLine{1171         cfden[ 3 * ( j + 0 ) + 2 ] = +( pbp[j] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbp[j] ) ).m\_re;}
\DoxyCodeLine{1172         cfden[ 3 * ( j + 1 ) + 0 ] = 1;}
\DoxyCodeLine{1173         cfden[ 3 * ( j + 1 ) + 1 ] = -\/( pbp[j+1] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbp[j+1] ) ).m\_re;}
\DoxyCodeLine{1174         cfden[ 3 * ( j + 1 ) + 2 ] = +( pbp[j+1] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbp[j+1] ) ).m\_re;}
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176         \textcolor{comment}{// complex conjugate quadratic sections gains computation:}}
\DoxyCodeLine{1177         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[i];}
\DoxyCodeLine{1178         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = p1 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( p1 );}
\DoxyCodeLine{1179         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = p2 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( p2 );}
\DoxyCodeLine{1180         \mbox{\hyperlink{classcomplex}{complex< T >}} gain3 = z1 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( z1 );}
\DoxyCodeLine{1181         \mbox{\hyperlink{classcomplex}{complex< T >}} gain4 = z2 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( z2 );}
\DoxyCodeLine{1182         \mbox{\hyperlink{classcomplex}{complex< T >}} gain5 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ z1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(z1) );}
\DoxyCodeLine{1183         \mbox{\hyperlink{classcomplex}{complex< T >}} gain6 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ z2)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(z2) );}
\DoxyCodeLine{1184         \mbox{\hyperlink{classcomplex}{complex< T >}} gain7 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(p1) );}
\DoxyCodeLine{1185         \mbox{\hyperlink{classcomplex}{complex< T >}} gain8 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p2)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(p2) );}
\DoxyCodeLine{1186 }
\DoxyCodeLine{1187         \mbox{\hyperlink{classcomplex}{complex< T >}} gain9 = gain0 * gain1 * gain2 / ( gain3 * gain4 ) * ( gain5 * gain6 ) / ( gain7 * gain8 );}
\DoxyCodeLine{1188         gain9 = \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( gain9 );}
\DoxyCodeLine{1189         gains[j+0] = gain9.m\_re;}
\DoxyCodeLine{1190         gains[j+1] = gains[j+0];}
\DoxyCodeLine{1191     \}}
\DoxyCodeLine{1192 }
\DoxyCodeLine{1193     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{1194     \textcolor{keywordflow}{if}( R == 1 )}
\DoxyCodeLine{1195     \{}
\DoxyCodeLine{1196         \textcolor{comment}{// pole transformation by means of square equation solve:}}
\DoxyCodeLine{1197         \mbox{\hyperlink{classcomplex}{complex< T >}} a( 1 / w0 , 0 );}
\DoxyCodeLine{1198         \mbox{\hyperlink{classcomplex}{complex< T >}} b( -\/plp[ N -\/ 1 ].m\_re * dW / w0 , -\/plp[ N -\/ 1 ].m\_im * dW / w0 );}
\DoxyCodeLine{1199         \mbox{\hyperlink{classcomplex}{complex< T >}} c( 1 , 0 );}
\DoxyCodeLine{1200         \mbox{\hyperlink{classcomplex}{complex< T >}} D = b * b -\/ a * c * 4;}
\DoxyCodeLine{1201         \mbox{\hyperlink{classcomplex}{complex< T >}} p1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1202         \mbox{\hyperlink{classcomplex}{complex< T >}} p2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1203 }
\DoxyCodeLine{1204         \textcolor{comment}{// zeros and poles bilinear transform:}}
\DoxyCodeLine{1205         zbp[ j + 0 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( +1 , 0 );}
\DoxyCodeLine{1206         zbp[ j + 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{1207         pbp[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p1 );}
\DoxyCodeLine{1208         pbp[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p2 );}
\DoxyCodeLine{1209 }
\DoxyCodeLine{1210         \textcolor{comment}{// digital filter coefficients computation:}}
\DoxyCodeLine{1211 }
\DoxyCodeLine{1212         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{1213         cfnum[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{1214         cfnum[ 3 * ( j + 0 ) + 1 ] = 0;}
\DoxyCodeLine{1215         cfnum[ 3 * ( j + 0 ) + 2 ] = -\/1;}
\DoxyCodeLine{1216 }
\DoxyCodeLine{1217         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{1218         cfden[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{1219         cfden[ 3 * ( j + 0 ) + 1 ] = -\/( pbp[j] + pbp[j+1] ).m\_re;}
\DoxyCodeLine{1220         cfden[ 3 * ( j + 0 ) + 2 ] = +( pbp[j] * pbp[j+1] ).m\_re;}
\DoxyCodeLine{1221 }
\DoxyCodeLine{1222         \textcolor{comment}{// complex conjugate quadratic sections gains computation:}}
\DoxyCodeLine{1223         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[N-\/1];}
\DoxyCodeLine{1224         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = p1 * p2;}
\DoxyCodeLine{1225         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = (\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p2);}
\DoxyCodeLine{1226         \mbox{\hyperlink{classcomplex}{complex< T >}} gain3 = gain0 * gain1 / gain2 * dW / w0;}
\DoxyCodeLine{1227         gains[j+0] = gain3.m\_re;}
\DoxyCodeLine{1228     \}}
\DoxyCodeLine{1229 }
\DoxyCodeLine{1230     \textcolor{comment}{// setting filter output gain:}}
\DoxyCodeLine{1231     gains[ 2*L+R ] = glp[N].m\_re;}
\DoxyCodeLine{1232 }
\DoxyCodeLine{1233     \textcolor{comment}{// memory free:}}
\DoxyCodeLine{1234     free( plp );}
\DoxyCodeLine{1235     free( zlp );}
\DoxyCodeLine{1236     free( glp );}
\DoxyCodeLine{1237     free( pbp );}
\DoxyCodeLine{1238     free( zbp );}
\DoxyCodeLine{1239     free( gbp );}
\DoxyCodeLine{1240 }
\DoxyCodeLine{1241     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ cfnum , cfden , gains , 2*L , R , 2*L+R  \};}
\DoxyCodeLine{1242 \}}
\DoxyCodeLine{1243 }
\DoxyCodeLine{1244 \textcolor{comment}{// Elliptic or Chebyshev II digital bandstop computation function:}}
\DoxyCodeLine{1245 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}} \_\_cheb2\_ellip\_digital\_bs\_\_( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fp , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BandWidth , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} type = 0 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_pass = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} g\_stop = 80 )}
\DoxyCodeLine{1246 \{}
\DoxyCodeLine{1247     \textcolor{comment}{// Fs           -\/ sampling frequency}}
\DoxyCodeLine{1248     \textcolor{comment}{// Fpass        -\/ passband frequency}}
\DoxyCodeLine{1249     \textcolor{comment}{// BandWidth    -\/ passband withd}}
\DoxyCodeLine{1250     \textcolor{comment}{// order        -\/ filter order}}
\DoxyCodeLine{1251     \textcolor{comment}{// coeffs\_num   -\/ quadratic sections numerator coefficients}}
\DoxyCodeLine{1252     \textcolor{comment}{// coeffs\_den   -\/ quadratic sections denominator coefficients}}
\DoxyCodeLine{1253     \textcolor{comment}{// gains        -\/ quadratic sections gains}}
\DoxyCodeLine{1254     \textcolor{comment}{// type         -\/ filter type ( 0 -\/ Butterworth , 1 -\/ Chebyshev )}}
\DoxyCodeLine{1255     \textcolor{comment}{// g\_stop       -\/ stopband attenuation in Db}}
\DoxyCodeLine{1256 }
\DoxyCodeLine{1257      order /= 2;}
\DoxyCodeLine{1258 }
\DoxyCodeLine{1259     \textcolor{comment}{// frequency deformation coefficient:}}
\DoxyCodeLine{1260     T w1 = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * Fp / 2 / Fs ) , w2 = tan( \mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * ( Fp + BandWidth ) / 2 / Fs );}
\DoxyCodeLine{1261 }
\DoxyCodeLine{1262     \textcolor{comment}{// allocate zeros and poles arrays:}}
\DoxyCodeLine{1263 }
\DoxyCodeLine{1264     \textcolor{comment}{// lowpass analogue prototype poles, zeros and gains:}}
\DoxyCodeLine{1265     \mbox{\hyperlink{structiir__zp}{iir\_zp < T >}} zp = ( !type ) ? \_\_cheb2\_zeros\_poles\_plain\_\_< T >( order , g\_stop ) : \_\_ellip\_zeros\_poles\_plain\_\_< T >( order , g\_pass , g\_stop );}
\DoxyCodeLine{1266     \mbox{\hyperlink{classcomplex}{complex< T >}} *plp = zp.plp;}
\DoxyCodeLine{1267     \mbox{\hyperlink{classcomplex}{complex< T >}} *glp = zp.glp;}
\DoxyCodeLine{1268     \mbox{\hyperlink{classcomplex}{complex< T >}} *zlp = zp.zlp;}
\DoxyCodeLine{1269     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = zp.L , R = zp.R , N = L + R;}
\DoxyCodeLine{1270 }
\DoxyCodeLine{1271     \textcolor{keywordflow}{if}( plp == 0 || zlp == 0 || glp == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{1272 }
\DoxyCodeLine{1273     \textcolor{comment}{// bandpass digital prototype poles, zeros and gains:}}
\DoxyCodeLine{1274     \mbox{\hyperlink{classcomplex}{complex< T >}} *pbs = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{1275     \mbox{\hyperlink{classcomplex}{complex< T >}} *zbs = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{1276     \mbox{\hyperlink{classcomplex}{complex< T >}} *gbs = ( \mbox{\hyperlink{classcomplex}{complex< T >}}* ) calloc( 2*N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classcomplex}{complex< T >}} ) );}
\DoxyCodeLine{1277 }
\DoxyCodeLine{1278     \textcolor{comment}{// coefficients matrix computation:}}
\DoxyCodeLine{1279      T  *cfnum = ( T * )calloc( 3 * (2*L+R) , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{1280      T  *cfden = ( T * )calloc( 3 * (2*L+R) , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{1281      T  *gains = ( T * )calloc( (2*L+R + 1) , \textcolor{keyword}{sizeof} ( T ) );}
\DoxyCodeLine{1282 }
\DoxyCodeLine{1283     \textcolor{keywordflow}{if}( pbs   == 0 || zbs   == 0 || gbs   == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{1284     \textcolor{keywordflow}{if}( cfnum == 0 || cfden == 0 || gains == 0 ) \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \}; \textcolor{comment}{// check if the memory is allocated...}}
\DoxyCodeLine{1285 }
\DoxyCodeLine{1286     \textcolor{comment}{// LP-\/BP BILLINEAR TRANSFORM:}}
\DoxyCodeLine{1287 }
\DoxyCodeLine{1288     \textcolor{comment}{// poles transformation:}}
\DoxyCodeLine{1289      T  w0 = w1 * w2;}
\DoxyCodeLine{1290      T  dW = w2 -\/ w1;}
\DoxyCodeLine{1291 }
\DoxyCodeLine{1292     \textcolor{comment}{// complex conjugate pairs:}}
\DoxyCodeLine{1293     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} j = 0;}
\DoxyCodeLine{1294 }
\DoxyCodeLine{1295     \textcolor{comment}{// auxiliary variables:}}
\DoxyCodeLine{1296     \mbox{\hyperlink{classcomplex}{complex< T >}} a , b , c , D , z1 , z2 , p1 , p2;}
\DoxyCodeLine{1297 }
\DoxyCodeLine{1298     \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < L ; i++ , j+=2 )}
\DoxyCodeLine{1299     \{}
\DoxyCodeLine{1300         \textcolor{comment}{// zeros frequency transformation by means of square equation solve:}}
\DoxyCodeLine{1301         a = -\/1 / w0;}
\DoxyCodeLine{1302         b = \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) / zlp[i] * dW / w0;}
\DoxyCodeLine{1303         c = -\/1;}
\DoxyCodeLine{1304         D = b * b -\/ a * c * 4;}
\DoxyCodeLine{1305         z1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1306         z2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1307 }
\DoxyCodeLine{1308         \textcolor{comment}{// poles frequency transformation by means of square equation solve:}}
\DoxyCodeLine{1309         a = -\/1 / w0;}
\DoxyCodeLine{1310         b = \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) / plp[i] * dW / w0;}
\DoxyCodeLine{1311         c = -\/1;}
\DoxyCodeLine{1312         D = b * b -\/ a * c * 4;}
\DoxyCodeLine{1313         p1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1314         p2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1315 }
\DoxyCodeLine{1316         \textcolor{comment}{// zeros and poles bilinear transform:}}
\DoxyCodeLine{1317         zbs[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + z1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ z1 );}
\DoxyCodeLine{1318         zbs[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + z2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ z2 );}
\DoxyCodeLine{1319         pbs[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p1 );}
\DoxyCodeLine{1320         pbs[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p2 );}
\DoxyCodeLine{1321 }
\DoxyCodeLine{1322         \textcolor{comment}{// filter coefficients computation:}}
\DoxyCodeLine{1323 }
\DoxyCodeLine{1324         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{1325         cfnum[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{1326         cfnum[ 3 * ( j + 0 ) + 1 ] = -\/( zbs[j] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zbs[j] ) ).m\_re;}
\DoxyCodeLine{1327         cfnum[ 3 * ( j + 0 ) + 2 ] = +( zbs[j] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zbs[j] ) ).m\_re;}
\DoxyCodeLine{1328         cfnum[ 3 * ( j + 1 ) + 0 ] = 1;}
\DoxyCodeLine{1329         cfnum[ 3 * ( j + 1 ) + 1 ] = -\/( zbs[j+1] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zbs[j+1] ) ).m\_re;}
\DoxyCodeLine{1330         cfnum[ 3 * ( j + 1 ) + 2 ] = +( zbs[j+1] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( zbs[j+1] ) ).m\_re;}
\DoxyCodeLine{1331 }
\DoxyCodeLine{1332         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{1333         cfden[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{1334         cfden[ 3 * ( j + 0 ) + 1 ] = -\/( pbs[j] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbs[j] ) ).m\_re;}
\DoxyCodeLine{1335         cfden[ 3 * ( j + 0 ) + 2 ] = +( pbs[j] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbs[j] ) ).m\_re;}
\DoxyCodeLine{1336         cfden[ 3 * ( j + 1 ) + 0 ] = 1;}
\DoxyCodeLine{1337         cfden[ 3 * ( j + 1 ) + 1 ] = -\/( pbs[j+1] + \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbs[j+1] ) ).m\_re;}
\DoxyCodeLine{1338         cfden[ 3 * ( j + 1 ) + 2 ] = +( pbs[j+1] * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( pbs[j+1] ) ).m\_re;}
\DoxyCodeLine{1339 }
\DoxyCodeLine{1340         \textcolor{comment}{// complex conjugate quadratic sections gains computation:}}
\DoxyCodeLine{1341         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = p1 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( p1 );}
\DoxyCodeLine{1342         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = p2 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( p2 );}
\DoxyCodeLine{1343         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = z1 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( z1 );}
\DoxyCodeLine{1344         \mbox{\hyperlink{classcomplex}{complex< T >}} gain3 = z2 * \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}( z2 );}
\DoxyCodeLine{1345         \mbox{\hyperlink{classcomplex}{complex< T >}} gain4 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ z1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(z1) );}
\DoxyCodeLine{1346         \mbox{\hyperlink{classcomplex}{complex< T >}} gain5 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ z2)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(z2) );}
\DoxyCodeLine{1347         \mbox{\hyperlink{classcomplex}{complex< T >}} gain6 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(p1) );}
\DoxyCodeLine{1348         \mbox{\hyperlink{classcomplex}{complex< T >}} gain7 = ( \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p2)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ \mbox{\hyperlink{special__functions_8h_a319cdc31249b735fc75ef40c9743e317}{\_\_conjf\_\_}}(p2) );}
\DoxyCodeLine{1349         \mbox{\hyperlink{classcomplex}{complex< T >}} gain8 = ( gain0 * gain1 ) / ( gain2 * gain3 ) * ( gain4 * gain5 ) / ( gain6 * gain7 );}
\DoxyCodeLine{1350         gain8 = \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( gain8 );}
\DoxyCodeLine{1351         gains[j+0] = gain8.m\_re;}
\DoxyCodeLine{1352         gains[j+1] = gains[j+0];}
\DoxyCodeLine{1353     \}}
\DoxyCodeLine{1354 }
\DoxyCodeLine{1355     \textcolor{comment}{// real odd pole:}}
\DoxyCodeLine{1356     \textcolor{keywordflow}{if}( R == 1 )}
\DoxyCodeLine{1357     \{}
\DoxyCodeLine{1358         \textcolor{comment}{// poles transformation by means of square equation solve:}}
\DoxyCodeLine{1359         \mbox{\hyperlink{classcomplex}{complex< T >}} a = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 / w0 , 0 );}
\DoxyCodeLine{1360         \mbox{\hyperlink{classcomplex}{complex< T >}} b = \mbox{\hyperlink{classcomplex}{complex< T >}}( dW , 0 ) / plp[N-\/1] / w0;}
\DoxyCodeLine{1361         \mbox{\hyperlink{classcomplex}{complex< T >}} c = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{1362         \mbox{\hyperlink{classcomplex}{complex< T >}} D = b * b -\/ a * c * 4;}
\DoxyCodeLine{1363         \mbox{\hyperlink{classcomplex}{complex< T >}} p1 = ( b*(-\/1) -\/ \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1364         \mbox{\hyperlink{classcomplex}{complex< T >}} p2 = ( b*(-\/1) + \mbox{\hyperlink{special__functions_8h_a01fec2085d62c37467538eeb9ae36e91}{\_\_sqrtf\_\_}}( D ) ) / 2 / a;}
\DoxyCodeLine{1365 }
\DoxyCodeLine{1366         \textcolor{comment}{// zeros and poles bilinear transform:}}
\DoxyCodeLine{1367         zbs[ j + 0 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( +1 , 0 );}
\DoxyCodeLine{1368         zbs[ j + 1 ] = \mbox{\hyperlink{classcomplex}{complex< T >}}( -\/1 , 0 );}
\DoxyCodeLine{1369         pbs[ j + 0 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p1 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p1 );}
\DoxyCodeLine{1370         pbs[ j + 1 ] = ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) + p2 ) / ( \mbox{\hyperlink{classcomplex}{complex< T >}}( 1 , 0 ) -\/ p2 );}
\DoxyCodeLine{1371 }
\DoxyCodeLine{1372         \textcolor{comment}{// digital filter coefficients computation:}}
\DoxyCodeLine{1373 }
\DoxyCodeLine{1374         \textcolor{comment}{// numerator:}}
\DoxyCodeLine{1375         cfnum[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{1376         cfnum[ 3 * ( j + 0 ) + 1 ] = 2 * ( w0 -\/ 1 ) / ( w0 + 1 );}
\DoxyCodeLine{1377         cfnum[ 3 * ( j + 0 ) + 2 ] = 1;}
\DoxyCodeLine{1378 }
\DoxyCodeLine{1379         \textcolor{comment}{// denominator:}}
\DoxyCodeLine{1380         cfden[ 3 * ( j + 0 ) + 0 ] = 1;}
\DoxyCodeLine{1381         cfden[ 3 * ( j + 0 ) + 1 ] = -\/( pbs[j]+pbs[j+1] ).m\_re;}
\DoxyCodeLine{1382         cfden[ 3 * ( j + 0 ) + 2 ] = +( pbs[j]*pbs[j+1] ).m\_re;}
\DoxyCodeLine{1383 }
\DoxyCodeLine{1384         \textcolor{comment}{// complex conjugate quadratic sections gains computation:}}
\DoxyCodeLine{1385         \mbox{\hyperlink{classcomplex}{complex< T >}} gain0 = glp[N-\/1];}
\DoxyCodeLine{1386         \mbox{\hyperlink{classcomplex}{complex< T >}} gain1 = p1 * p2;}
\DoxyCodeLine{1387         \mbox{\hyperlink{classcomplex}{complex< T >}} gain2 = \mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) / plp[N-\/1] / (-\/1);}
\DoxyCodeLine{1388         \mbox{\hyperlink{classcomplex}{complex< T >}} gain3 = (\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p1)*(\mbox{\hyperlink{classcomplex}{complex< T >}}(1,0) -\/ p2);}
\DoxyCodeLine{1389         \mbox{\hyperlink{classcomplex}{complex< T >}} gain4 = gain0 * gain1 * gain2 / gain3 / w0 * ( 1 + w0 );}
\DoxyCodeLine{1390         gains[j+0] = gain4.m\_re;}
\DoxyCodeLine{1391     \}}
\DoxyCodeLine{1392 }
\DoxyCodeLine{1393     \textcolor{comment}{// setting filter output gain:}}
\DoxyCodeLine{1394     gains[ 2*L+R ] = glp[N].m\_re;}
\DoxyCodeLine{1395 }
\DoxyCodeLine{1396     \textcolor{comment}{// memory free:}}
\DoxyCodeLine{1397     free( plp );}
\DoxyCodeLine{1398     free( zlp );}
\DoxyCodeLine{1399     free( glp );}
\DoxyCodeLine{1400     free( pbs );}
\DoxyCodeLine{1401     free( zbs );}
\DoxyCodeLine{1402     free( gbs );}
\DoxyCodeLine{1403 }
\DoxyCodeLine{1404     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}}\{ cfnum , cfden , gains , 2*L , R , 2*L+R  \};}
\DoxyCodeLine{1405 \}}
\DoxyCodeLine{1406 }
\DoxyCodeLine{1407 \textcolor{comment}{// iir buffers memory allocation function:}}
\DoxyCodeLine{1408 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__bf}{iir\_bf<T>}} \_\_iir\_bf\_alloc\_\_( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} N )}
\DoxyCodeLine{1409 \{}
\DoxyCodeLine{1410     \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer<T>}} *bx = ( \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer<T>}}* ) calloc( N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer<T>}} ) );}
\DoxyCodeLine{1411     \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer<T>}} *by = ( \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer<T>}}* ) calloc( N , \textcolor{keyword}{sizeof} ( \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer<T>}} ) );}
\DoxyCodeLine{1412     \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < N ; i++ )}
\DoxyCodeLine{1413     \{}
\DoxyCodeLine{1414         bx[i].allocate( 4 );}
\DoxyCodeLine{1415         by[i].allocate( 3 );}
\DoxyCodeLine{1416     \}}
\DoxyCodeLine{1417 }
\DoxyCodeLine{1418     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__bf}{iir\_bf< T >}}\{ bx , by , N \};}
\DoxyCodeLine{1419 \}}
\DoxyCodeLine{1420 }
\DoxyCodeLine{1421 \textcolor{comment}{// iir buffers memory deallocation function:}}
\DoxyCodeLine{1422 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \textcolor{keywordtype}{void} \_\_iir\_bf\_free\_\_( \mbox{\hyperlink{structiir__bf}{iir\_bf<T>}} bf )}
\DoxyCodeLine{1423 \{}
\DoxyCodeLine{1424     \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer<T>}} *bx = bf.bx , *by = bf.by;}
\DoxyCodeLine{1425     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} N = bf.N;}
\DoxyCodeLine{1426 }
\DoxyCodeLine{1427     \textcolor{keywordflow}{if}( bx != 0 )}
\DoxyCodeLine{1428     \{}
\DoxyCodeLine{1429         \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < N ; i++ ) bx[i].deallocate();}
\DoxyCodeLine{1430         free( bx );}
\DoxyCodeLine{1431         bf.bx = 0;}
\DoxyCodeLine{1432     \}}
\DoxyCodeLine{1433 }
\DoxyCodeLine{1434     \textcolor{keywordflow}{if}( by != 0 )}
\DoxyCodeLine{1435     \{}
\DoxyCodeLine{1436         \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < N ; i++ ) by[i].deallocate();}
\DoxyCodeLine{1437         free( by );}
\DoxyCodeLine{1438         bf.by = 0;}
\DoxyCodeLine{1439     \}}
\DoxyCodeLine{1440     bf.N = -\/1;}
\DoxyCodeLine{1441 \}}
\DoxyCodeLine{1442 }
\DoxyCodeLine{1443 \textcolor{comment}{// iir zeros / poles plain memory deallocation function:}}
\DoxyCodeLine{1444 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \textcolor{keywordtype}{void} \_\_iir\_zp\_free\_\_( \mbox{\hyperlink{structiir__zp}{iir\_zp< T >}} zp )}
\DoxyCodeLine{1445 \{}
\DoxyCodeLine{1446     \textcolor{keywordflow}{if}( zp.glp != 0 ) \{ free( zp.glp ); zp.glp = 0; \}}
\DoxyCodeLine{1447     \textcolor{keywordflow}{if}( zp.zlp != 0 ) \{ free( zp.zlp ); zp.zlp = 0; \}}
\DoxyCodeLine{1448     \textcolor{keywordflow}{if}( zp.plp != 0 ) \{ free( zp.plp ); zp.plp = 0; \}}
\DoxyCodeLine{1449     zp.N = zp.L = zp.R = -\/1;}
\DoxyCodeLine{1450 \}}
\DoxyCodeLine{1451 }
\DoxyCodeLine{1452 \textcolor{comment}{// iir coefficients memory deallocation function:}}
\DoxyCodeLine{1453 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \textcolor{keywordtype}{void} \_\_iir\_cf\_free\_\_( \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}} cf )}
\DoxyCodeLine{1454 \{}
\DoxyCodeLine{1455     \textcolor{keywordflow}{if}( cf.cfnum != 0 ) \{ free( cf.cfnum ); cf.cfnum = 0; \}}
\DoxyCodeLine{1456     \textcolor{keywordflow}{if}( cf.cfden != 0 ) \{ free( cf.cfden ); cf.cfden = 0; \}}
\DoxyCodeLine{1457     \textcolor{keywordflow}{if}( cf.gains != 0 ) \{ free( cf.gains ); cf.gains = 0; \}}
\DoxyCodeLine{1458     cf.N = cf.L = cf.R = -\/1;}
\DoxyCodeLine{1459 \}}
\DoxyCodeLine{1460 }
\DoxyCodeLine{1461 \textcolor{comment}{// filtering template function:}}
\DoxyCodeLine{1462 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \textcolor{keyword}{extern} T \_\_filt\_\_( T *input , T *cfnum , T *cfden , T *gains  , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} N ,  \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer< T >}} *buff\_sx , \mbox{\hyperlink{classmirror__ring__buffer}{mirror\_ring\_buffer< T >}} *buff\_sy )}
\DoxyCodeLine{1463 \{}
\DoxyCodeLine{1464     \textcolor{comment}{// initialization:}}
\DoxyCodeLine{1465     T sum\_num = 0 , sum\_den = 0 , out = 0;}
\DoxyCodeLine{1466 }
\DoxyCodeLine{1467     \textcolor{comment}{// filtering:}}
\DoxyCodeLine{1468     buff\_sx[0].fill\_buff( input );}
\DoxyCodeLine{1469     \textcolor{keywordflow}{for} ( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < N ; i++)}
\DoxyCodeLine{1470     \{}
\DoxyCodeLine{1471         sum\_num = gains[i]*( buff\_sx[ i ][ 0 ] * cfnum[ 3 * i + 0 ] + buff\_sx[ i ][ 1 ] * cfnum[ 3 * i + 1 ] + buff\_sx[ i ][ 2 ] * cfnum[ 3 * i + 2 ] );}
\DoxyCodeLine{1472         sum\_den = ( buff\_sy[ i ][ 0 ] * cfden[ 3 * i + 1 ] + buff\_sy[ i ][ 1 ] * cfden[ 3 * i + 2 ] );}
\DoxyCodeLine{1473         out = sum\_num -\/ sum\_den;}
\DoxyCodeLine{1474         buff\_sy[ i ].fill\_buff( \&out );}
\DoxyCodeLine{1475         \textcolor{keywordflow}{if}( i < N -\/ 1 ) buff\_sx[ i + 1 ].fill\_buff( \&out );}
\DoxyCodeLine{1476     \}}
\DoxyCodeLine{1477     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1478 \}}
\DoxyCodeLine{1479 }
\DoxyCodeLine{1480 \textcolor{comment}{// frequency response computation function:}}
\DoxyCodeLine{1481 \textcolor{keyword}{template}< \textcolor{keyword}{typename} T > \mbox{\hyperlink{structiir__fr}{iir\_fr< T >}} \_\_freq\_resp\_\_( T *cfnum , T *cfden , T *gains , \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} N , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} F )}
\DoxyCodeLine{1482 \{}
\DoxyCodeLine{1483     \textcolor{comment}{// sampling period:}}
\DoxyCodeLine{1484     T Ts = 1 / Fs;}
\DoxyCodeLine{1485 }
\DoxyCodeLine{1486     \textcolor{comment}{// transfer function initialization:}}
\DoxyCodeLine{1487     \mbox{\hyperlink{classcomplex}{complex< T >}} tsf = \mbox{\hyperlink{classcomplex}{complex< T >}}( 1, 0 );}
\DoxyCodeLine{1488 }
\DoxyCodeLine{1489     \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < N ; i++ )}
\DoxyCodeLine{1490     \{}
\DoxyCodeLine{1491         \textcolor{comment}{// complex exponents:}}
\DoxyCodeLine{1492         \mbox{\hyperlink{classcomplex}{complex< T >}} z0 = \mbox{\hyperlink{classcomplex}{complex<\_\_fx64>}}( cos( -\/\mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * F * Ts * 0 ) , sin( -\/\mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * F * Ts * 0 ) );}
\DoxyCodeLine{1493         \mbox{\hyperlink{classcomplex}{complex< T >}} z1 = \mbox{\hyperlink{classcomplex}{complex<\_\_fx64>}}( cos( -\/\mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * F * Ts * 1 ) , sin( -\/\mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * F * Ts * 1 ) );}
\DoxyCodeLine{1494         \mbox{\hyperlink{classcomplex}{complex< T >}} z2 = \mbox{\hyperlink{classcomplex}{complex<\_\_fx64>}}( cos( -\/\mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * F * Ts * 2 ) , sin( -\/\mbox{\hyperlink{special__functions_8h_a2750dfdda752269a036f487a4a34b849}{PI2}} * F * Ts * 2 ) );}
\DoxyCodeLine{1495 }
\DoxyCodeLine{1496         \textcolor{comment}{// transfer function:}}
\DoxyCodeLine{1497         \mbox{\hyperlink{classcomplex}{complex< T >}} num =  z0 * cfnum[ 3 * i + 0 ] + z1 * cfnum[ 3 * i + 1 ] + z2 * cfnum[ 3 * i + 2 ];}
\DoxyCodeLine{1498         \mbox{\hyperlink{classcomplex}{complex< T >}} den =  z0 * cfden[ 3 * i + 0 ] + z1 * cfden[ 3 * i + 1 ] + z2 * cfden[ 3 * i + 2 ];}
\DoxyCodeLine{1499         tsf *= num / den * gains[i];}
\DoxyCodeLine{1500     \}}
\DoxyCodeLine{1501 }
\DoxyCodeLine{1502     \textcolor{comment}{// multiply by an output gain:}}
\DoxyCodeLine{1503     tsf *= gains[N];}
\DoxyCodeLine{1504 }
\DoxyCodeLine{1505     \textcolor{comment}{// output:}}
\DoxyCodeLine{1506     \textcolor{keywordflow}{return} \mbox{\hyperlink{structiir__fr}{iir\_fr< T >}}\{ \mbox{\hyperlink{special__functions_8h_a0765799ca4abb9e483c3ef879af01fb6}{\_\_absf\_\_}}( tsf ) , \mbox{\hyperlink{special__functions_8h_a9d52070119bede5b645e38ff626ab49d}{\_\_argf\_\_}}( tsf ) \};}
\DoxyCodeLine{1507 \}}
\DoxyCodeLine{1508 }
\DoxyCodeLine{1509 \textcolor{comment}{// DEBUGGING FUNCTIONS:}}
\DoxyCodeLine{1510 }
\DoxyCodeLine{1511 \textcolor{preprocessor}{\#ifndef \_\_ALG\_PLATFORM}}
\DoxyCodeLine{1512 }
\DoxyCodeLine{1513 \textcolor{comment}{// show coeffs:}}
\DoxyCodeLine{1514 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \textcolor{keywordtype}{void} \_\_show\_coeffs\_\_( \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}} coeffs )}
\DoxyCodeLine{1515 \{}
\DoxyCodeLine{1516     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} L = coeffs.L , R = coeffs.R , N = L + R;}
\DoxyCodeLine{1517     \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} *cfnum = coeffs.cfnum;}
\DoxyCodeLine{1518     \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} *cfden = coeffs.cfden;}
\DoxyCodeLine{1519     \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} *gains = coeffs.gains;}
\DoxyCodeLine{1520     \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}}  fgain = 1;}
\DoxyCodeLine{1521 }
\DoxyCodeLine{1522     \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < N ; i++ )}
\DoxyCodeLine{1523     \{}
\DoxyCodeLine{1524         printf( \textcolor{stringliteral}{"{}section: \%d \(\backslash\)n "{}} , i + 1 );}
\DoxyCodeLine{1525         printf( \textcolor{stringliteral}{"{}num: \%.12f \%.12f \%.12f \(\backslash\)n "{}} , cfnum[ 3 * i + 0 ] , cfnum[ 3 * i + 1 ] , cfnum[ 3 * i + 2 ] );}
\DoxyCodeLine{1526         printf( \textcolor{stringliteral}{"{}den: \%.12f \%.12f \%.12f \(\backslash\)n "{}} , cfden[ 3 * i + 0 ] , cfden[ 3 * i + 1 ] , cfden[ 3 * i + 2 ] );}
\DoxyCodeLine{1527         printf( \textcolor{stringliteral}{"{}gf0: \%.12f \(\backslash\)n\(\backslash\)n "{}} , gains[i] );}
\DoxyCodeLine{1528         fgain *= gains[i];}
\DoxyCodeLine{1529     \}}
\DoxyCodeLine{1530     fgain *= gains[N];}
\DoxyCodeLine{1531     printf( \textcolor{stringliteral}{"{}output gain = : \%.12f \(\backslash\)n "{}} , gains[N] );}
\DoxyCodeLine{1532     printf( \textcolor{stringliteral}{"{}filter gain = : \%.12f \(\backslash\)n "{}} , fgain    );}
\DoxyCodeLine{1533 \}}
\DoxyCodeLine{1534 }
\DoxyCodeLine{1535 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \textcolor{keywordtype}{void} \_\_show\_iir\_\_( \mbox{\hyperlink{structiir__sp}{iir\_sp}} sp , \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}} cf , \textcolor{keyword}{const} \textcolor{keywordtype}{char} *name )}
\DoxyCodeLine{1536 \{}
\DoxyCodeLine{1537     printf( \textcolor{stringliteral}{"{}\%s "{}} , name );}
\DoxyCodeLine{1538 }
\DoxyCodeLine{1539     \textcolor{keywordflow}{switch} ( sp.type )}
\DoxyCodeLine{1540     \{}
\DoxyCodeLine{1541         \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{1542         printf( \textcolor{stringliteral}{"{}lowpass specifications: \(\backslash\)n"{}} );}
\DoxyCodeLine{1543         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1544 }
\DoxyCodeLine{1545         \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{1546         printf( \textcolor{stringliteral}{"{}highpass specifications: \(\backslash\)n"{}} );}
\DoxyCodeLine{1547         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1548 }
\DoxyCodeLine{1549         \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{1550         printf( \textcolor{stringliteral}{"{}bandpass specifications: \(\backslash\)n"{}} );}
\DoxyCodeLine{1551         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1552 }
\DoxyCodeLine{1553         \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{1554         printf( \textcolor{stringliteral}{"{}bandstop specifications: \(\backslash\)n"{}} );}
\DoxyCodeLine{1555         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1556     \}}
\DoxyCodeLine{1557 }
\DoxyCodeLine{1558     printf( \textcolor{stringliteral}{"{}\(\backslash\)n"{}} );}
\DoxyCodeLine{1559     \textcolor{keywordflow}{if}( sp.Fs > 0    ) \{ printf( \textcolor{stringliteral}{"{}Fs    = \%.6f Hz \(\backslash\)n"{}}   , sp.Fs    ); \}}
\DoxyCodeLine{1560     \textcolor{keywordflow}{if}( sp.Ts > 0    ) \{ printf( \textcolor{stringliteral}{"{}Ts    = \%.6f s  \(\backslash\)n"{}}   , sp.Ts    ); \}}
\DoxyCodeLine{1561     \textcolor{keywordflow}{if}( sp.Fn > 0    ) \{ printf( \textcolor{stringliteral}{"{}Fn    = \%.6f Hz \(\backslash\)n"{}}   , sp.Fn    ); \}}
\DoxyCodeLine{1562     \textcolor{keywordflow}{if}( sp.Fc > 0    ) \{ printf( \textcolor{stringliteral}{"{}Fc    = \%.6f Hz \(\backslash\)n"{}}   , sp.Fc    ); \}}
\DoxyCodeLine{1563     \textcolor{keywordflow}{if}( sp.BW > 0    ) \{ printf( \textcolor{stringliteral}{"{}BW    = \%.6f Hz \(\backslash\)n"{}}   , sp.BW    ); \}}
\DoxyCodeLine{1564     \textcolor{keywordflow}{if}( sp.Gs > 0    ) \{ printf( \textcolor{stringliteral}{"{}Gs    = \%.6f Db \(\backslash\)n"{}}   , sp.Gs    ); \}}
\DoxyCodeLine{1565     \textcolor{keywordflow}{if}( sp.Gp > 0    ) \{ printf( \textcolor{stringliteral}{"{}Gp    = \%.6f Db \(\backslash\)n"{}}   , sp.Gp    ); \}}
\DoxyCodeLine{1566     \textcolor{keywordflow}{if}( sp.order > 0 ) \{ printf( \textcolor{stringliteral}{"{}order = \%d      \(\backslash\)n"{}}   , sp.order ); \}}
\DoxyCodeLine{1567     \textcolor{keywordflow}{if}( cf.N > 0     ) \{ printf( \textcolor{stringliteral}{"{}N     = \%d      \(\backslash\)n"{}}   , cf.N     ); \}}
\DoxyCodeLine{1568     \textcolor{keywordflow}{if}( cf.L > 0     ) \{ printf( \textcolor{stringliteral}{"{}L     = \%d      \(\backslash\)n"{}}   , cf.L     ); \}}
\DoxyCodeLine{1569     \textcolor{keywordflow}{if}( cf.R > 0     ) \{ printf( \textcolor{stringliteral}{"{}R     = \%d      \(\backslash\)n\(\backslash\)n"{}} , cf.R     ); \}}
\DoxyCodeLine{1570 }
\DoxyCodeLine{1571     \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} fgain = 1;}
\DoxyCodeLine{1572     \textcolor{keywordflow}{if}( cf.cfden != 0 \&\& cf.cfnum != 0 \&\& cf.gains != 0 )}
\DoxyCodeLine{1573     \{}
\DoxyCodeLine{1574         printf( \textcolor{stringliteral}{"{}coefficients: \(\backslash\)n\(\backslash\)n"{}} );}
\DoxyCodeLine{1575         \textcolor{keywordflow}{for}( \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} i = 0 ; i < cf.N ; i++ )}
\DoxyCodeLine{1576         \{}
\DoxyCodeLine{1577             printf( \textcolor{stringliteral}{"{} section \%d : \(\backslash\)n"{}} , i );}
\DoxyCodeLine{1578             printf( \textcolor{stringliteral}{"{} numerator  : \%.12f \%.12f \%.12f \(\backslash\)n"{}} , cf.cfnum[ 3 * i + 0 ] , cf.cfnum[ 3 * i + 1 ]  , cf.cfnum[ 3 * i + 2 ] );}
\DoxyCodeLine{1579             printf( \textcolor{stringliteral}{"{} denominator: \%.12f \%.12f \%.12f \(\backslash\)n"{}} , cf.cfden[ 3 * i + 0 ] , cf.cfden[ 3 * i + 1 ]  , cf.cfden[ 3 * i + 2 ] );}
\DoxyCodeLine{1580             printf( \textcolor{stringliteral}{"{} gain       : \%.12f \(\backslash\)n\(\backslash\)n"{}} , cf.gains[i] );}
\DoxyCodeLine{1581             fgain *= cf.gains[i];}
\DoxyCodeLine{1582         \}}
\DoxyCodeLine{1583         printf( \textcolor{stringliteral}{"{}output gain: \%.12f \(\backslash\)n"{}} , cf.gains[ cf.N ]         );}
\DoxyCodeLine{1584         printf( \textcolor{stringliteral}{"{}filter gain: \%.12f \(\backslash\)n\(\backslash\)n"{}} , fgain * cf.gains[ cf.N ] );}
\DoxyCodeLine{1585     \}}
\DoxyCodeLine{1586     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1587     \{}
\DoxyCodeLine{1588         printf( \textcolor{stringliteral}{"{}coefficients : coefficients have not been computed yet... \(\backslash\)n"{}} );}
\DoxyCodeLine{1589     \}}
\DoxyCodeLine{1590 \}}
\DoxyCodeLine{1591 }
\DoxyCodeLine{1592 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1593 }
\DoxyCodeLine{1594 \textcolor{comment}{// template Butterworth filter:}}
\DoxyCodeLine{1595 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \textcolor{keyword}{class }\mbox{\hyperlink{classbutterworth}{butterworth}}}
\DoxyCodeLine{1596 \{}
\DoxyCodeLine{1597 \textcolor{keyword}{public}:}
\DoxyCodeLine{1598     \textcolor{comment}{// filter specification , coefficients and buffers:}}
\DoxyCodeLine{1599     \mbox{\hyperlink{structiir__sp}{iir\_sp}}      m\_sp;}
\DoxyCodeLine{1600     \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}} m\_cf;}
\DoxyCodeLine{1601     \mbox{\hyperlink{structiir__bf}{iir\_bf< T >}} m\_bf;}
\DoxyCodeLine{1602 \textcolor{keyword}{public}:}
\DoxyCodeLine{1603 }
\DoxyCodeLine{1604     \textcolor{comment}{// filter output:}}
\DoxyCodeLine{1605     T m\_out , m\_Km , m\_pH;}
\DoxyCodeLine{1606 }
\DoxyCodeLine{1607     \textcolor{comment}{// initializations:}}
\DoxyCodeLine{1608     \textcolor{keywordtype}{void} lp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 1 )             \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , -\/1 , Gs , -\/1 , order , 0 \}; \}}
\DoxyCodeLine{1609     \textcolor{keywordtype}{void} hp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 1 )             \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , -\/1 , Gs , -\/1 , order , 1 \}; \}}
\DoxyCodeLine{1610     \textcolor{keywordtype}{void} bp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BW ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 1 ) \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , BW , Gs , -\/1 , order , 2 \}; \}}
\DoxyCodeLine{1611     \textcolor{keywordtype}{void} bs\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BW ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 1 ) \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , BW , Gs , -\/1 , order , 3 \}; \}}
\DoxyCodeLine{1612 }
\DoxyCodeLine{1613     \textcolor{comment}{// memory allocation function:}}
\DoxyCodeLine{1614     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} allocate()}
\DoxyCodeLine{1615     \{}
\DoxyCodeLine{1616         \textcolor{keywordflow}{switch} ( m\_sp.type )}
\DoxyCodeLine{1617         \{}
\DoxyCodeLine{1618             \textcolor{keywordflow}{case} 0: \textcolor{comment}{// lowpass computation}}
\DoxyCodeLine{1619             m\_cf = \_\_butt\_cheb1\_digital\_lp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.order , 0 , m\_sp.Gs );}
\DoxyCodeLine{1620             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1621 }
\DoxyCodeLine{1622             \textcolor{keywordflow}{case} 1: \textcolor{comment}{// highpass computation:}}
\DoxyCodeLine{1623             m\_cf = \_\_butt\_cheb1\_digital\_hp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.order , 0 , m\_sp.Gs );}
\DoxyCodeLine{1624             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1625 }
\DoxyCodeLine{1626             \textcolor{keywordflow}{case} 2: \textcolor{comment}{// bandpass computation}}
\DoxyCodeLine{1627             m\_cf = \_\_butt\_cheb1\_digital\_bp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.BW , m\_sp.order , 0 , m\_sp.Gs );}
\DoxyCodeLine{1628             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1629 }
\DoxyCodeLine{1630             \textcolor{keywordflow}{case} 3: \textcolor{comment}{// bandstop computation}}
\DoxyCodeLine{1631             m\_cf = \_\_butt\_cheb1\_digital\_bs\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.BW , m\_sp.order , 0 , m\_sp.Gs );}
\DoxyCodeLine{1632             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1633         \}}
\DoxyCodeLine{1634 }
\DoxyCodeLine{1635         m\_bf = ( ( m\_cf.cfnum != 0 ) \&\& ( m\_cf.cfden != 0 ) \&\& ( m\_cf.gains != 0 ) ) ? \_\_iir\_bf\_alloc\_\_< T >( m\_cf.N ) : \mbox{\hyperlink{structiir__bf}{iir\_bf< T >}}\{ 0 , 0 , -\/1 \} ;}
\DoxyCodeLine{1636         \textcolor{keywordflow}{return} ( m\_bf.bx != 0 \&\& m\_bf.by != 0 );}
\DoxyCodeLine{1637     \}}
\DoxyCodeLine{1638 }
\DoxyCodeLine{1639     \textcolor{comment}{// memory deallocation function:}}
\DoxyCodeLine{1640     \textcolor{keywordtype}{void} deallocate()}
\DoxyCodeLine{1641     \{}
\DoxyCodeLine{1642         \_\_iir\_bf\_free\_\_< T >( m\_bf );}
\DoxyCodeLine{1643         \_\_iir\_cf\_free\_\_< T >( m\_cf );}
\DoxyCodeLine{1644     \}}
\DoxyCodeLine{1645 }
\DoxyCodeLine{1646     \textcolor{comment}{// default constructor:}}
\DoxyCodeLine{1647     \mbox{\hyperlink{classbutterworth}{butterworth}}()}
\DoxyCodeLine{1648     \{}
\DoxyCodeLine{1649         m\_cf = \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \};}
\DoxyCodeLine{1650         m\_bf = \mbox{\hyperlink{structiir__bf}{iir\_bf<T>}}\{ 0 , 0 , -\/1 \};}
\DoxyCodeLine{1651         m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}   \{ 4000 , 1 / 4000 , 50 , 100 , -\/1 , 1 , -\/1 , 4 , 0 \};}
\DoxyCodeLine{1652     \}}
\DoxyCodeLine{1653 }
\DoxyCodeLine{1654     \textcolor{comment}{// default destructor:}}
\DoxyCodeLine{1655     \mbox{\hyperlink{classbutterworth}{\string~butterworth}}()\{ deallocate(); \}}
\DoxyCodeLine{1656 }
\DoxyCodeLine{1657     \textcolor{comment}{// coefficients computation virtual function:}}
\DoxyCodeLine{1658 }
\DoxyCodeLine{1659     \textcolor{comment}{// filtering function:}}
\DoxyCodeLine{1660     T filt( T *input ) \{ \textcolor{keywordflow}{return} ( m\_out = \_\_filt\_\_< T >( input , m\_cf.cfnum , m\_cf.cfden , m\_cf.gains , m\_cf.N , m\_bf.bx , m\_bf.by ) ); \}}
\DoxyCodeLine{1661 }
\DoxyCodeLine{1662     \textcolor{keyword}{inline} T operator () (  T *input  ) \{ \textcolor{keywordflow}{return} filt( input ); \}}
\DoxyCodeLine{1663 }
\DoxyCodeLine{1664 \textcolor{preprocessor}{    \#ifndef \_\_ALG\_PLATFORM}}
\DoxyCodeLine{1665     \textcolor{keywordtype}{void} show\_properties() \{ \_\_show\_iir\_\_< T >( m\_sp , m\_cf , \textcolor{stringliteral}{"{}Butterworth"{}} ); \}}
\DoxyCodeLine{1666 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1667 \};}
\DoxyCodeLine{1668 }
\DoxyCodeLine{1669 \textcolor{comment}{// template Chebyshev type I filter:}}
\DoxyCodeLine{1670 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \textcolor{keyword}{class }\mbox{\hyperlink{classchebyshev__1}{chebyshev\_1}}}
\DoxyCodeLine{1671 \{}
\DoxyCodeLine{1672 \textcolor{keyword}{public}:}
\DoxyCodeLine{1673     \textcolor{comment}{// filter specification , coefficients and buffers:}}
\DoxyCodeLine{1674     \mbox{\hyperlink{structiir__sp}{iir\_sp}}      m\_sp;}
\DoxyCodeLine{1675     \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}} m\_cf;}
\DoxyCodeLine{1676     \mbox{\hyperlink{structiir__bf}{iir\_bf< T >}} m\_bf;}
\DoxyCodeLine{1677 \textcolor{keyword}{public}:}
\DoxyCodeLine{1678 }
\DoxyCodeLine{1679     \textcolor{comment}{// filter output:}}
\DoxyCodeLine{1680     T m\_out , m\_Km , m\_pH;}
\DoxyCodeLine{1681 }
\DoxyCodeLine{1682     \textcolor{comment}{// initializations:}}
\DoxyCodeLine{1683     \textcolor{keywordtype}{void} lp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 1 )             \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , -\/1 , Gs , -\/1 , order , 0 \}; \}}
\DoxyCodeLine{1684     \textcolor{keywordtype}{void} hp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 1 )             \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , -\/1 , Gs , -\/1 , order , 1 \}; \}}
\DoxyCodeLine{1685     \textcolor{keywordtype}{void} bp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BW ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 1 ) \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , BW , Gs , -\/1 , order , 2 \}; \}}
\DoxyCodeLine{1686     \textcolor{keywordtype}{void} bs\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BW ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 1 ) \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , BW , Gs , -\/1 , order , 3 \}; \}}
\DoxyCodeLine{1687 }
\DoxyCodeLine{1688     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} allocate()}
\DoxyCodeLine{1689     \{}
\DoxyCodeLine{1690         \textcolor{keywordflow}{switch} ( m\_sp.type )}
\DoxyCodeLine{1691         \{}
\DoxyCodeLine{1692             \textcolor{keywordflow}{case} 0: \textcolor{comment}{// lowpass computation}}
\DoxyCodeLine{1693             m\_cf = \_\_butt\_cheb1\_digital\_lp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.order , 1 , m\_sp.Gs );}
\DoxyCodeLine{1694             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1695 }
\DoxyCodeLine{1696             \textcolor{keywordflow}{case} 1: \textcolor{comment}{// highpass computation:}}
\DoxyCodeLine{1697             m\_cf = \_\_butt\_cheb1\_digital\_hp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.order , 1 , m\_sp.Gs );}
\DoxyCodeLine{1698             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1699 }
\DoxyCodeLine{1700             \textcolor{keywordflow}{case} 2: \textcolor{comment}{// bandpass computation}}
\DoxyCodeLine{1701             m\_cf = \_\_butt\_cheb1\_digital\_bp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.BW , m\_sp.order , 1 , m\_sp.Gs );}
\DoxyCodeLine{1702             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1703 }
\DoxyCodeLine{1704             \textcolor{keywordflow}{case} 3: \textcolor{comment}{// bandstop computation}}
\DoxyCodeLine{1705             m\_cf = \_\_butt\_cheb1\_digital\_bs\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.BW , m\_sp.order , 1 , m\_sp.Gs );}
\DoxyCodeLine{1706             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1707         \}}
\DoxyCodeLine{1708 }
\DoxyCodeLine{1709         m\_bf = ( ( m\_cf.cfnum != 0 ) \&\& ( m\_cf.cfden != 0 ) \&\& ( m\_cf.gains != 0 ) ) ? \_\_iir\_bf\_alloc\_\_< T >( m\_cf.N ) : \mbox{\hyperlink{structiir__bf}{iir\_bf< T >}}\{ 0 , 0 , -\/1 \} ;}
\DoxyCodeLine{1710         \textcolor{keywordflow}{return} ( m\_bf.bx != 0 \&\& m\_bf.by != 0 );}
\DoxyCodeLine{1711     \}}
\DoxyCodeLine{1712 }
\DoxyCodeLine{1713     \textcolor{keywordtype}{void} deallocate()}
\DoxyCodeLine{1714     \{}
\DoxyCodeLine{1715         \_\_iir\_bf\_free\_\_< T >( m\_bf );}
\DoxyCodeLine{1716         \_\_iir\_cf\_free\_\_< T >( m\_cf );}
\DoxyCodeLine{1717     \}}
\DoxyCodeLine{1718 }
\DoxyCodeLine{1719     \textcolor{comment}{// default constructor:}}
\DoxyCodeLine{1720     \mbox{\hyperlink{classchebyshev__1}{chebyshev\_1}}()}
\DoxyCodeLine{1721     \{}
\DoxyCodeLine{1722         m\_cf = \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \};}
\DoxyCodeLine{1723         m\_bf = \mbox{\hyperlink{structiir__bf}{iir\_bf<T>}}\{ 0 , 0 , -\/1 \};}
\DoxyCodeLine{1724         m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}   \{ 4000 , 1 / 4000 , 50 , 100 , -\/1 , 1 , -\/1 , 4 , 0 \};}
\DoxyCodeLine{1725     \}}
\DoxyCodeLine{1726 }
\DoxyCodeLine{1727     \textcolor{comment}{// default destructor:}}
\DoxyCodeLine{1728     \mbox{\hyperlink{classchebyshev__1}{\string~chebyshev\_1}}()\{ deallocate(); \}}
\DoxyCodeLine{1729 }
\DoxyCodeLine{1730     \textcolor{comment}{// coefficients computation virtual function:}}
\DoxyCodeLine{1731 }
\DoxyCodeLine{1732     \textcolor{comment}{// filtering function:}}
\DoxyCodeLine{1733     T filt( T *input ) \{ \textcolor{keywordflow}{return} ( m\_out = \_\_filt\_\_< T >( input , m\_cf.cfnum , m\_cf.cfden , m\_cf.gains , m\_cf.N , m\_bf.bx , m\_bf.by ) ); \}}
\DoxyCodeLine{1734 }
\DoxyCodeLine{1735     \textcolor{keyword}{inline} T operator () (  T *input  ) \{ \textcolor{keywordflow}{return} filt( input ); \}}
\DoxyCodeLine{1736 }
\DoxyCodeLine{1737 \textcolor{preprocessor}{    \#ifndef \_\_ALG\_PLATFORM}}
\DoxyCodeLine{1738     \textcolor{keywordtype}{void} show\_properties() \{ \_\_show\_iir\_\_< T >( m\_sp , m\_cf , \textcolor{stringliteral}{"{}Chebyshev\_I"{}} ); \}}
\DoxyCodeLine{1739 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1740 \};}
\DoxyCodeLine{1741 }
\DoxyCodeLine{1742 \textcolor{comment}{// template Chebyshev type II filter:}}
\DoxyCodeLine{1743 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \textcolor{keyword}{class }\mbox{\hyperlink{classchebyshev__2}{chebyshev\_2}}}
\DoxyCodeLine{1744 \{}
\DoxyCodeLine{1745 \textcolor{keyword}{public}:}
\DoxyCodeLine{1746     \textcolor{comment}{// filter specification , coefficients and buffers:}}
\DoxyCodeLine{1747     \mbox{\hyperlink{structiir__sp}{iir\_sp}}      m\_sp;}
\DoxyCodeLine{1748     \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}} m\_cf;}
\DoxyCodeLine{1749     \mbox{\hyperlink{structiir__bf}{iir\_bf< T >}} m\_bf;}
\DoxyCodeLine{1750 \textcolor{keyword}{public}:}
\DoxyCodeLine{1751 }
\DoxyCodeLine{1752     \textcolor{comment}{// filter output:}}
\DoxyCodeLine{1753     T m\_out , m\_Km , m\_pH;}
\DoxyCodeLine{1754 }
\DoxyCodeLine{1755     \textcolor{comment}{// initializations:}}
\DoxyCodeLine{1756     \textcolor{keywordtype}{void} lp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gp = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 80 )             \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , -\/1 , Gs , Gp , order , 0 \}; \}}
\DoxyCodeLine{1757     \textcolor{keywordtype}{void} hp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gp = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 80 )             \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , -\/1 , Gs , Gp , order , 1 \}; \}}
\DoxyCodeLine{1758     \textcolor{keywordtype}{void} bp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BW ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gp = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 80 ) \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , BW , Gs , Gp , order , 2 \}; \}}
\DoxyCodeLine{1759     \textcolor{keywordtype}{void} bs\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BW ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gp = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 80 ) \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , BW , Gs , Gp , order , 3 \}; \}}
\DoxyCodeLine{1760 }
\DoxyCodeLine{1761     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} allocate()}
\DoxyCodeLine{1762     \{}
\DoxyCodeLine{1763         \textcolor{keywordflow}{switch} ( m\_sp.type )}
\DoxyCodeLine{1764         \{}
\DoxyCodeLine{1765             \textcolor{keywordflow}{case} 0: \textcolor{comment}{// lowpass computation}}
\DoxyCodeLine{1766             m\_cf = \_\_cheb2\_ellip\_digital\_lp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.order , 0 , m\_sp.Gp , m\_sp.Gs );}
\DoxyCodeLine{1767             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1768 }
\DoxyCodeLine{1769             \textcolor{keywordflow}{case} 1: \textcolor{comment}{// highpass computation:}}
\DoxyCodeLine{1770             m\_cf = \_\_cheb2\_ellip\_digital\_hp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.order , 0 , m\_sp.Gp , m\_sp.Gs );}
\DoxyCodeLine{1771             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1772 }
\DoxyCodeLine{1773             \textcolor{keywordflow}{case} 2: \textcolor{comment}{// bandpass computation}}
\DoxyCodeLine{1774             m\_cf = \_\_cheb2\_ellip\_digital\_bp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.BW , m\_sp.order , 0 , m\_sp.Gp , m\_sp.Gs );}
\DoxyCodeLine{1775             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1776 }
\DoxyCodeLine{1777             \textcolor{keywordflow}{case} 3: \textcolor{comment}{// bandstop computation}}
\DoxyCodeLine{1778             m\_cf = \_\_cheb2\_ellip\_digital\_bs\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.BW , m\_sp.order , 0 , m\_sp.Gp , m\_sp.Gs );}
\DoxyCodeLine{1779             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1780         \}}
\DoxyCodeLine{1781 }
\DoxyCodeLine{1782         m\_bf = ( ( m\_cf.cfnum != 0 ) \&\& ( m\_cf.cfden != 0 ) \&\& ( m\_cf.gains != 0 ) ) ? \_\_iir\_bf\_alloc\_\_< T >( m\_cf.N ) : \mbox{\hyperlink{structiir__bf}{iir\_bf< T >}}\{ 0 , 0 , -\/1 \} ;}
\DoxyCodeLine{1783         \textcolor{keywordflow}{return} ( m\_bf.bx != 0 \&\& m\_bf.by != 0 );}
\DoxyCodeLine{1784     \}}
\DoxyCodeLine{1785 }
\DoxyCodeLine{1786     \textcolor{keywordtype}{void} deallocate()}
\DoxyCodeLine{1787     \{}
\DoxyCodeLine{1788         \_\_iir\_bf\_free\_\_< T >( m\_bf );}
\DoxyCodeLine{1789         \_\_iir\_cf\_free\_\_< T >( m\_cf );}
\DoxyCodeLine{1790     \}}
\DoxyCodeLine{1791 }
\DoxyCodeLine{1792     \textcolor{comment}{// default constructor:}}
\DoxyCodeLine{1793     \mbox{\hyperlink{classchebyshev__2}{chebyshev\_2}}()}
\DoxyCodeLine{1794     \{}
\DoxyCodeLine{1795         m\_cf = \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \};}
\DoxyCodeLine{1796         m\_bf = \mbox{\hyperlink{structiir__bf}{iir\_bf<T>}}\{ 0 , 0 , -\/1 \};}
\DoxyCodeLine{1797         m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}   \{ 4000 , 1 / 4000 , 50 , 100 , -\/1 , 1 , 80 , 4 , 0 \};}
\DoxyCodeLine{1798     \}}
\DoxyCodeLine{1799 }
\DoxyCodeLine{1800     \textcolor{comment}{// default destructor:}}
\DoxyCodeLine{1801     \mbox{\hyperlink{classchebyshev__2}{\string~chebyshev\_2}}()\{ deallocate(); \}}
\DoxyCodeLine{1802 }
\DoxyCodeLine{1803     \textcolor{comment}{// coefficients computation virtual function:}}
\DoxyCodeLine{1804 }
\DoxyCodeLine{1805     \textcolor{comment}{// filtering function:}}
\DoxyCodeLine{1806     T filt( T *input ) \{ \textcolor{keywordflow}{return} ( m\_out = \_\_filt\_\_< T >( input , m\_cf.cfnum , m\_cf.cfden , m\_cf.gains , m\_cf.N , m\_bf.bx , m\_bf.by ) ); \}}
\DoxyCodeLine{1807 }
\DoxyCodeLine{1808     \textcolor{keyword}{inline} T operator () (  T *input  ) \{ \textcolor{keywordflow}{return} filt( input ); \}}
\DoxyCodeLine{1809 }
\DoxyCodeLine{1810 \textcolor{preprocessor}{    \#ifndef \_\_ALG\_PLATFORM}}
\DoxyCodeLine{1811     \textcolor{keywordtype}{void} show\_properties() \{ \_\_show\_iir\_\_< T >( m\_sp , m\_cf , \textcolor{stringliteral}{"{}Chebyshev\_II"{}} ); \}}
\DoxyCodeLine{1812 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1813 \};}
\DoxyCodeLine{1814 }
\DoxyCodeLine{1815 \textcolor{comment}{// template Chebyshev type II filter:}}
\DoxyCodeLine{1816 \textcolor{keyword}{template} < \textcolor{keyword}{typename} T > \textcolor{keyword}{class }\mbox{\hyperlink{classelliptic}{elliptic}}}
\DoxyCodeLine{1817 \{}
\DoxyCodeLine{1818 \textcolor{keyword}{public}:}
\DoxyCodeLine{1819     \textcolor{comment}{// filter specification , coefficients and buffers:}}
\DoxyCodeLine{1820     \mbox{\hyperlink{structiir__sp}{iir\_sp}}      m\_sp;}
\DoxyCodeLine{1821     \mbox{\hyperlink{structiir__cf}{iir\_cf< T >}} m\_cf;}
\DoxyCodeLine{1822     \mbox{\hyperlink{structiir__bf}{iir\_bf< T >}} m\_bf;}
\DoxyCodeLine{1823 \textcolor{keyword}{public}:}
\DoxyCodeLine{1824 }
\DoxyCodeLine{1825     \textcolor{comment}{// filter output:}}
\DoxyCodeLine{1826     T m\_out , m\_Km , m\_pH;}
\DoxyCodeLine{1827 }
\DoxyCodeLine{1828     \textcolor{comment}{// initializations:}}
\DoxyCodeLine{1829     \textcolor{keywordtype}{void} lp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gp = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 80 )             \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , -\/1 , Gs , Gp , order , 0 \}; \}}
\DoxyCodeLine{1830     \textcolor{keywordtype}{void} hp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gp = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 80 )             \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , -\/1 , Gs , Gp , order , 1 \}; \}}
\DoxyCodeLine{1831     \textcolor{keywordtype}{void} bp\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BW ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gp = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 80 ) \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , BW , Gs , Gp , order , 2 \}; \}}
\DoxyCodeLine{1832     \textcolor{keywordtype}{void} bs\_init( \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fs , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fn , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Fc , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} BW ,  \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} order , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gp = 1 , \mbox{\hyperlink{special__functions_8h_a55c00d61c4ad25c012a8fb3fa8a57cdb}{\_\_fx64}} Gs = 80 ) \{ m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}\{ Fs , 1 / Fs , Fn , Fc , BW , Gs , Gp , order , 3 \}; \}}
\DoxyCodeLine{1833 }
\DoxyCodeLine{1834     \textcolor{comment}{// memory allocation function:}}
\DoxyCodeLine{1835     \mbox{\hyperlink{special__functions_8h_a7d1671ef10aab0922515d7ed25120d0e}{\_\_ix32}} allocate()}
\DoxyCodeLine{1836     \{}
\DoxyCodeLine{1837         \textcolor{keywordflow}{switch} ( m\_sp.type )}
\DoxyCodeLine{1838         \{}
\DoxyCodeLine{1839             \textcolor{keywordflow}{case} 0: \textcolor{comment}{// lowpass computation}}
\DoxyCodeLine{1840             m\_cf = \_\_cheb2\_ellip\_digital\_lp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.order , 1 , m\_sp.Gp , m\_sp.Gs );}
\DoxyCodeLine{1841             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1842 }
\DoxyCodeLine{1843             \textcolor{keywordflow}{case} 1: \textcolor{comment}{// highpass computation:}}
\DoxyCodeLine{1844             m\_cf = \_\_cheb2\_ellip\_digital\_hp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.order , 1 , m\_sp.Gp , m\_sp.Gs );}
\DoxyCodeLine{1845             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1846 }
\DoxyCodeLine{1847             \textcolor{keywordflow}{case} 2: \textcolor{comment}{// bandpass computation}}
\DoxyCodeLine{1848             m\_cf = \_\_cheb2\_ellip\_digital\_bp\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.BW , m\_sp.order , 1 , m\_sp.Gp , m\_sp.Gs );}
\DoxyCodeLine{1849             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1850 }
\DoxyCodeLine{1851             \textcolor{keywordflow}{case} 3: \textcolor{comment}{// bandstop computation}}
\DoxyCodeLine{1852             m\_cf = \_\_cheb2\_ellip\_digital\_bs\_\_< T >( m\_sp.Fs , m\_sp.Fc , m\_sp.BW , m\_sp.order , 1 , m\_sp.Gp , m\_sp.Gs );}
\DoxyCodeLine{1853             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1854         \}}
\DoxyCodeLine{1855 }
\DoxyCodeLine{1856         m\_bf = ( ( m\_cf.cfnum != 0 ) \&\& ( m\_cf.cfden != 0 ) \&\& ( m\_cf.gains != 0 ) ) ? \_\_iir\_bf\_alloc\_\_< T >( m\_cf.N ) : \mbox{\hyperlink{structiir__bf}{iir\_bf< T >}}\{ 0 , 0 , -\/1 \} ;}
\DoxyCodeLine{1857         \textcolor{keywordflow}{return} ( m\_bf.bx != 0 \&\& m\_bf.by != 0 );}
\DoxyCodeLine{1858     \}}
\DoxyCodeLine{1859 }
\DoxyCodeLine{1860     \textcolor{comment}{// memory deallocation function:}}
\DoxyCodeLine{1861     \textcolor{keywordtype}{void} deallocate()}
\DoxyCodeLine{1862     \{}
\DoxyCodeLine{1863         \_\_iir\_bf\_free\_\_< T >( m\_bf );}
\DoxyCodeLine{1864         \_\_iir\_cf\_free\_\_< T >( m\_cf );}
\DoxyCodeLine{1865     \}}
\DoxyCodeLine{1866 }
\DoxyCodeLine{1867     \textcolor{comment}{// default constructor:}}
\DoxyCodeLine{1868     \mbox{\hyperlink{classelliptic}{elliptic}}()}
\DoxyCodeLine{1869     \{}
\DoxyCodeLine{1870         m\_cf = \mbox{\hyperlink{structiir__cf}{iir\_cf<T>}}\{ 0 , 0 , 0 , -\/1 , -\/1 , -\/1 \};}
\DoxyCodeLine{1871         m\_bf = \mbox{\hyperlink{structiir__bf}{iir\_bf<T>}}\{ 0 , 0 , -\/1 \};}
\DoxyCodeLine{1872         m\_sp = \mbox{\hyperlink{structiir__sp}{iir\_sp}}   \{ 4000 , 1 / 4000 , 50 , 100 , -\/1 , 1 , 80 , 4 , 0 \};}
\DoxyCodeLine{1873     \}}
\DoxyCodeLine{1874 }
\DoxyCodeLine{1875     \textcolor{comment}{// default destructor:}}
\DoxyCodeLine{1876     \mbox{\hyperlink{classelliptic}{\string~elliptic}}()\{ deallocate(); \}}
\DoxyCodeLine{1877 }
\DoxyCodeLine{1878 }
\DoxyCodeLine{1879     \textcolor{comment}{// filtering function:}}
\DoxyCodeLine{1880     T filt( T *input ) \{ \textcolor{keywordflow}{return} ( m\_out = \_\_filt\_\_< T >( input , m\_cf.cfnum , m\_cf.cfden , m\_cf.gains , m\_cf.N , m\_bf.bx , m\_bf.by ) ); \}}
\DoxyCodeLine{1881 }
\DoxyCodeLine{1882     \textcolor{keyword}{inline} T operator () (  T *input  ) \{ \textcolor{keywordflow}{return} filt( input ); \}}
\DoxyCodeLine{1883 }
\DoxyCodeLine{1884     \textcolor{comment}{// debugging function:}}
\DoxyCodeLine{1885 \textcolor{preprocessor}{    \#ifndef \_\_ALG\_PLATFORM}}
\DoxyCodeLine{1886     \textcolor{keywordtype}{void} show\_properties() \{ \_\_show\_iir\_\_< T >( m\_sp , m\_cf , \textcolor{stringliteral}{"{}Chebyshev\_II"{}} ); \}}
\DoxyCodeLine{1887 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1888 \};}
\DoxyCodeLine{1889 }
\DoxyCodeLine{1890 \textcolor{comment}{// customized macros exclusion to avoid aliases during compilation:}}
\DoxyCodeLine{1891 \textcolor{preprocessor}{\#undef \_\_fx32}}
\DoxyCodeLine{1892 \textcolor{preprocessor}{\#undef \_\_fx64}}
\DoxyCodeLine{1893 \textcolor{preprocessor}{\#undef \_\_ix32}}
\DoxyCodeLine{1894 \textcolor{preprocessor}{\#undef PI0}}
\DoxyCodeLine{1895 \textcolor{preprocessor}{\#undef PI2}}
\DoxyCodeLine{1896 \textcolor{preprocessor}{\#undef DEBUG}}
\DoxyCodeLine{1897 }
\DoxyCodeLine{1898 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
